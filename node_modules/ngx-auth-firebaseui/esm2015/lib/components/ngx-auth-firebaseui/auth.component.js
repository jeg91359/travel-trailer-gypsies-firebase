import { __awaiter, __decorate, __param } from "tslib";
import { isPlatformBrowser } from '@angular/common';
import { AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, EventEmitter, forwardRef, Inject, Input, OnChanges, OnDestroy, OnInit, Output, PLATFORM_ID, SimpleChanges, TemplateRef, ViewChild } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { FormControl, FormGroup, Validators } from '@angular/forms';
// ANGULAR MATERIAL
import { MatTabGroup } from '@angular/material/tabs';
import { MatDialog, MatDialogRef } from '@angular/material/dialog';
// ANGULAR FIRE
import { AngularFireAuth } from '@angular/fire/auth';
// Third PARTY
import { MatPasswordStrengthComponent } from '@angular-material-extensions/password-strength';
import { LegalityDialogComponent } from '..';
import { AuthProcessService, AuthProvider } from '../../services/auth-process.service';
import { NgxAuthFirebaseuiAnimations } from '../../animations';
import { NgxAuthFirebaseUIConfigToken } from '../../tokens';
export const EMAIL_REGEX = new RegExp(['^(([^<>()[\\]\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\.,;:\\s@\"]+)*)',
    '|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.',
    '[0-9]{1,3}\])|(([a-zA-Z\\-0-9]+\\.)+',
    '[a-zA-Z]{2,}))$'].join(''));
// tslint:disable-next-line:max-line-length
export const PHONE_NUMBER_REGEX = new RegExp(['^[+]{0,1}[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\.]{0,1}[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\./0-9]{4,12}$'].join(''));
let AuthComponent = class AuthComponent {
    constructor(
    // tslint:disable-next-line:ban-types
    platformId, config, auth, authProcess, dialog, activatedRoute, changeDetectorRef) {
        this.platformId = platformId;
        this.config = config;
        this.auth = auth;
        this.authProcess = authProcess;
        this.dialog = dialog;
        this.activatedRoute = activatedRoute;
        this.changeDetectorRef = changeDetectorRef;
        //  google, facebook, twitter, github as array or all as one single string
        this.providers = AuthProvider.ALL;
        this.registrationEnabled = true;
        this.resetPasswordEnabled = true;
        this.guestEnabled = true;
        this.selectedTabChange = new EventEmitter();
        // Password strength api
        this.enableLengthRule = true;
        this.enableLowerCaseLetterRule = true;
        this.enableUpperCaseLetterRule = true;
        this.enableDigitRule = true;
        this.enableSpecialCharRule = true;
        // tslint:disable-next-line:no-output-on-prefix
        this.onStrengthChanged = new EventEmitter();
        this.verifyEmailGoBackText = 'Go back';
        this.signOutText = 'Sign out';
        // Customize the text
        // Reset Password Tab
        this.resetPasswordTabText = 'Reset e-mail address to password';
        this.resetPasswordInputText = 'Reset e-mail address to password';
        this.resetPasswordErrorRequiredText = 'E-mail is required to reset the password!';
        this.resetPasswordErrorPatternText = 'Please enter a valid e-mail address';
        this.resetPasswordActionButtonText = 'Reset';
        this.resetPasswordInstructionsText = 'Reset requested. Check your e-mail instructions.';
        // SignIn Tab
        this.signInTabText = 'Sign in';
        this.signInCardTitleText = 'Signing in';
        this.loginButtonText = 'Log In';
        this.forgotPasswordButtonText = 'Forgot Password ?';
        // Common
        this.nameText = 'Name';
        this.nameErrorRequiredText = 'Name is required';
        this.nameErrorMinLengthText = 'The name is too short!';
        this.nameErrorMaxLengthText = 'The name is too long!';
        this.emailText = 'E-mail';
        this.emailErrorRequiredText = 'E-mail is required';
        this.emailErrorPatternText = 'Please enter a valid e-mail address';
        this.passwordText = 'Password';
        this.passwordErrorRequiredText = 'Password is required';
        this.passwordErrorMinLengthText = 'The password is too short!';
        this.passwordErrorMaxLengthText = 'The password is too long!';
        // Register Tab
        this.registerTabText = 'Register';
        this.registerCardTitleText = 'Registration';
        this.registerButtonText = 'Register';
        this.guestButtonText = 'continue as guest';
        // email confirmation component
        this.emailConfirmationTitle = 'Confirm your e-mail address!';
        // tslint:disable-next-line:max-line-length
        this.emailConfirmationText = `A confirmation e-mail has been sent to you. Check your inbox and click on the link "Confirm my e-mail" to confirm your e-mail address.`;
        this.authProvider = AuthProvider;
        this.authenticationError = false;
        this.passReset = false;
        this.authProviders = AuthProvider;
        this.onSuccess = authProcess.onSuccessEmitter;
        this.onError = authProcess.onErrorEmitter;
    }
    get color() {
        return this.authenticationError ? 'warn' : 'primary';
    }
    ngOnInit() {
        if (isPlatformBrowser(this.platformId)) {
            this.onErrorSubscription = this.onError.subscribe(() => this.authenticationError = true);
        }
        this.min = this.min != null ? Math.max(this.min, this.config.passwordMinLength) : this.config.passwordMinLength;
        this.max = this.max != null ? Math.min(this.max, this.config.passwordMaxLength) : this.config.passwordMaxLength;
        this.goBackURL = this.chooseBackUrl();
        this.updateAuthSnackbarMessages();
        // auth form's initialization
        this._initSignInFormGroupBuilder();
        this._initSignUpFormGroupBuilder();
        this._initResetPasswordFormGroupBuilder();
    }
    ngAfterViewInit() {
        if (this.passwordStrength) {
            this.passwordStrength.onStrengthChanged.subscribe((strength) => {
                this.onStrengthChanged.emit(strength);
            });
        }
    }
    ngOnChanges(changes) {
        if (changes.messageOnAuthSuccess || changes.messageOnAuthError) {
            this.updateAuthSnackbarMessages();
        }
        if (changes.min) {
            this.min = this.min != null ? Math.max(this.min, this.config.passwordMinLength) : this.config.passwordMinLength;
        }
        if (changes.max) {
            this.max = this.max != null ? Math.min(this.max, this.config.passwordMaxLength) : this.config.passwordMaxLength;
        }
        if (changes.goBackURL) {
            this.goBackURL = this.chooseBackUrl();
        }
    }
    ngOnDestroy() {
        if (this.onErrorSubscription) {
            this.onErrorSubscription.unsubscribe();
        }
    }
    onTabChange(event) {
        this.selectedTabChange.emit(event);
        this.tabIndex = event.index;
    }
    signOut() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.isLoading = true;
                this.changeDetectorRef.markForCheck();
                yield this.authProcess.signOut();
            }
            finally {
                this.isLoading = false;
                this.tabIndex = 0;
                this.changeDetectorRef.markForCheck();
            }
        });
    }
    signIn() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.signInFormGroup.valid) {
                return;
            }
            try {
                this.isLoading = true;
                this.changeDetectorRef.markForCheck();
                yield this.authProcess.signInWith(this.authProviders.EmailAndPassword, {
                    email: this.signInFormGroup.value.email,
                    password: this.signInFormGroup.value.password
                });
            }
            finally {
                this.isLoading = false;
                this.changeDetectorRef.markForCheck();
            }
        });
    }
    updateAuthSnackbarMessages() {
        this.authProcess.messageOnAuthSuccess = this.messageOnAuthSuccess;
        this.authProcess.messageOnAuthError = this.messageOnAuthError;
    }
    createForgotPasswordTab() {
        this.passwordResetWished = true;
        this.tabIndex = 2;
        this.changeDetectorRef.markForCheck();
    }
    processLegalSignUP(authProvider) {
        if (this.tosUrl || this.privacyPolicyUrl) {
            const params = {
                tosUrl: this.tosUrl,
                privacyPolicyUrl: this.privacyPolicyUrl,
                authProvider
            };
            this.dialogRef = this.dialog.open(LegalityDialogComponent, { data: params });
            this.dialogRef.afterClosed().subscribe((result) => {
                if (result && result.checked) {
                    this._afterSignUpMiddleware(result.authProvider).then(() => this.signUpFormGroup.reset());
                }
                this.dialogRef = null;
            });
        }
        else {
            this._afterSignUpMiddleware(authProvider).then(() => this.signUpFormGroup.reset());
        }
    }
    signUp() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.isLoading = true;
                this.changeDetectorRef.markForCheck();
                return yield this.authProcess.signUp(this.signUpFormGroup.value.name, {
                    email: this.signUpFormGroup.value.email,
                    password: this.signUpFormGroup.value.password
                });
            }
            finally {
                this.isLoading = false;
                this.changeDetectorRef.markForCheck();
            }
        });
    }
    signUpAnonymously() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.isLoading = true;
                this.changeDetectorRef.markForCheck();
                yield this.authProcess.signInWith(this.authProvider.ANONYMOUS);
            }
            finally {
                this.isLoading = false;
                this.changeDetectorRef.markForCheck();
            }
        });
    }
    resetPassword() {
        this.authProcess.resetPassword(this.resetPasswordEmailFormControl.value)
            .then(() => {
            this.passReset = true;
            // this.tabIndex = 2;
            this.changeDetectorRef.markForCheck();
        });
    }
    chooseBackUrl() {
        return this.activatedRoute.snapshot.queryParams.redirectUrl || this.goBackURL || '/';
    }
    _initSignInFormGroupBuilder() {
        this.signInFormGroup = new FormGroup({});
        this.signInFormGroup.registerControl('email', this.signInEmailFormControl = new FormControl('', [
            Validators.required,
            Validators.pattern(EMAIL_REGEX)
        ]));
        this.signInFormGroup.registerControl('password', this.sigInPasswordFormControl = new FormControl('', [
            Validators.required,
            Validators.minLength(this.min),
            Validators.maxLength(this.max)
        ]));
    }
    _initSignUpFormGroupBuilder() {
        this.signUpFormGroup = new FormGroup({
            name: this.sigUpNameFormControl = new FormControl('', [
                Validators.required,
                Validators.minLength(this.config.nameMinLength),
                Validators.maxLength(this.config.nameMaxLength)
            ]),
            email: this.sigUpEmailFormControl = new FormControl('', [
                Validators.required,
                Validators.pattern(EMAIL_REGEX)
            ]),
            password: this.sigUpPasswordFormControl = new FormControl('', [
                Validators.required,
                Validators.minLength(this.min),
                Validators.maxLength(this.max),
            ])
        });
    }
    _initResetPasswordFormGroupBuilder() {
        this.resetPasswordFormGroup = new FormGroup({
            email: this.resetPasswordEmailFormControl = new FormControl('', [
                Validators.required,
                Validators.pattern(EMAIL_REGEX)
            ])
        });
    }
    _afterSignUpMiddleware(authProvider) {
        if (authProvider === this.authProvider.ANONYMOUS) {
            return this.signUpAnonymously();
        }
        return this.signUp();
    }
};
AuthComponent.ctorParameters = () => [
    { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
    { type: undefined, decorators: [{ type: Inject, args: [forwardRef(() => NgxAuthFirebaseUIConfigToken),] }] },
    { type: AngularFireAuth },
    { type: AuthProcessService },
    { type: MatDialog },
    { type: ActivatedRoute },
    { type: ChangeDetectorRef }
];
__decorate([
    ViewChild(MatTabGroup, { static: false })
], AuthComponent.prototype, "matTabGroup", void 0);
__decorate([
    ViewChild(MatPasswordStrengthComponent, { static: false })
], AuthComponent.prototype, "passwordStrength", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "providers", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "providersTheme", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "appearance", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "tabIndex", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "registrationEnabled", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordEnabled", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "guestEnabled", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "tosUrl", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "privacyPolicyUrl", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "goBackURL", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "messageOnAuthSuccess", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "messageOnAuthError", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "messageOnEmailConfirmationSuccess", void 0);
__decorate([
    Output()
], AuthComponent.prototype, "onSuccess", void 0);
__decorate([
    Output()
], AuthComponent.prototype, "onError", void 0);
__decorate([
    Output()
], AuthComponent.prototype, "selectedTabChange", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "enableLengthRule", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "enableLowerCaseLetterRule", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "enableUpperCaseLetterRule", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "enableDigitRule", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "enableSpecialCharRule", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "min", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "max", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "customValidator", void 0);
__decorate([
    Output()
], AuthComponent.prototype, "onStrengthChanged", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "verifyEmailTemplate", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "verifyEmailTitleText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "verifyEmailConfirmationText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "verifyEmailGoBackText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "sendNewVerificationEmailText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "signOutText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordTabText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordInputText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordErrorRequiredText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordErrorPatternText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordActionButtonText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "resetPasswordInstructionsText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "signInTabText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "signInCardTitleText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "loginButtonText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "forgotPasswordButtonText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "nameText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "nameErrorRequiredText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "nameErrorMinLengthText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "nameErrorMaxLengthText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "emailText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "emailErrorRequiredText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "emailErrorPatternText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "passwordText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "passwordErrorRequiredText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "passwordErrorMinLengthText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "passwordErrorMaxLengthText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "registerTabText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "registerCardTitleText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "registerButtonText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "guestButtonText", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "emailConfirmationTitle", void 0);
__decorate([
    Input()
], AuthComponent.prototype, "emailConfirmationText", void 0);
AuthComponent = __decorate([
    Component({
        selector: 'ngx-auth-firebaseui',
        template: "<ng-container *ngIf=\"authProcess.user$ | async as user; else showForm\">\n\n  <!-- This component will be shown when:\n    - we just sent a verification mail (notably after sign up)\n    - we arrived from the guard after trying to access a protected route even though we are connected\n  -->\n  <div\n    *ngIf=\"(config.guardProtectedRoutesUntilEmailIsVerified && !user.emailVerified) || (authProcess.emailConfirmationSent && !user.emailVerified); else signedInUser\"\n    fxLayout=\"row\" fxLayoutAlign=\"center center\">\n    <ngx-auth-firebaseui-email-confirmation\n      (signOut)=\"signOut()\"\n      [email]=\"user.email\"\n      [goBackURL]=\"goBackURL\"\n      [messageOnEmailConfirmationSuccess]=\"messageOnEmailConfirmationSuccess\"\n      [sendNewVerificationEmailText]=\"sendNewVerificationEmailText\"\n      [signOutText]=\"signOutText\"\n      [template]=\"verifyEmailTemplate\"\n      [verifyEmailConfirmationText]=\"verifyEmailConfirmationText\"\n      [verifyEmailGoBackText]=\"verifyEmailGoBackText\"\n      [verifyEmailTitleText]=\"verifyEmailTitleText\">\n    </ngx-auth-firebaseui-email-confirmation>\n  </div>\n\n  <ng-template #signedInUser>\n    <div class=\"signed-in-container\" fxLayout=\"column\" fxLayoutAlign=\"center center\">\n      <img *ngIf=\"user?.photoURL; else noPhoto\" [src]=\"user?.photoURL\" class=\"account-circle\">\n      <ng-template #noPhoto>\n        <mat-icon class=\"account-circle\">account_circle</mat-icon>\n      </ng-template>\n      <div class=\"user-display-name mat-title\">{{ user?.displayName }}</div>\n      <div class=\"user-email mat-body-2\">{{ user?.email }}</div>\n      <div class=\"actions\">\n        <mat-progress-bar *ngIf=\"isLoading\" mode=\"indeterminate\"></mat-progress-bar>\n        <a [routerLink]=\"goBackURL\" class=\"go-back-button action-button\" color=\"primary\"\n           mat-stroked-button>{{ verifyEmailGoBackText }}</a>\n        <button (click)=\"signOut()\" class=\"sign-out-button action-button\" color=\"warn\"\n                mat-stroked-button>{{ signOutText }}</button>\n      </div>\n    </div>\n  </ng-template>\n\n</ng-container>\n\n<ng-template #showForm>\n  <mat-tab-group (selectedTabChange)=\"onTabChange($event)\" [color]=\"color\" [selectedIndex]=\"tabIndex\">\n    <!--Sign in tab-->\n    <mat-tab [label]=\"signInTabText\">\n      <mat-card>\n        <mat-card-title>{{signInCardTitleText}}</mat-card-title>\n        <mat-card-content>\n          <form (ngSubmit)=\"signIn()\"\n                [@animateStagger]=\"{ value: '50' }\"\n                [formGroup]=\"signInFormGroup\">\n            <div fxLayout=\"column\" fxLayoutAlign=\"center\">\n              <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{emailText}}</mat-label>\n                <input formControlName=\"email\"\n                       matInput\n                       required>\n                <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n                <mat-error *ngIf=\"signInEmailFormControl.hasError('required')\">\n                  {{emailErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"signInEmailFormControl.hasError('pattern')\">\n                  {{emailErrorPatternText}}\n                </mat-error>\n              </mat-form-field>\n\n              <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{passwordText}}</mat-label>\n                <input [maxlength]=\"max\" [minlength]=\"min\" [type]=\"togglePass.type\" formControlName=\"password\" matInput\n                       required/>\n                <mat-pass-toggle-visibility #togglePass matSuffix></mat-pass-toggle-visibility>\n                <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n                <mat-hint align=\"end\" aria-live=\"polite\"> {{ signInFormGroup.value.password.length }}\n                  / {{ max }} </mat-hint>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('required')\">\n                  {{passwordErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('minlength')\">\n                  {{ passwordErrorMinLengthText }}\n                </mat-error>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('maxlength')\">\n                  {{ passwordErrorMaxLengthText }}\n                </mat-error>\n              </mat-form-field>\n\n              <button [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                      [color]=\"color\"\n                      [disabled]=\"signInFormGroup.invalid\"\n                      class=\"space-top\"\n                      mat-raised-button\n                      style=\"margin-top: 20px\"\n                      type=\"submit\">\n                {{loginButtonText}}\n              </button>\n\n            </div>\n          </form>\n\n          <div fxLayoutAlign=\"center\">\n            <button (click)=\"createForgotPasswordTab()\"\n                    *ngIf=\"resetPasswordEnabled\"\n                    [@animate]=\"{ value: '*', params: { x: '-50px' } }\"\n                    [color]=\"color\"\n                    class=\"space-top\"\n                    mat-button>\n              {{forgotPasswordButtonText}}\n            </button>\n          </div>\n\n        </mat-card-content>\n        <mat-card-footer *ngIf=\"isLoading\">\n          <mat-progress-bar [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n                            mode=\"indeterminate\"></mat-progress-bar>\n        </mat-card-footer>\n      </mat-card>\n    </mat-tab>\n\n    <!--tab register-->\n    <mat-tab *ngIf=\"registrationEnabled\" [label]=\"registerTabText\">\n      <mat-card>\n        <mat-card-title>{{registerCardTitleText}}</mat-card-title>\n        <mat-card-content fxLayout=\"column\" fxLayoutAlign=\"center\">\n          <form (ngSubmit)=\"signUpFormGroup.valid &&\n            processLegalSignUP(authProvider.EmailAndPassword)\"\n                [@animateStagger]=\"{ value: '50' }\" [formGroup]=\"signUpFormGroup\">\n            <div fxLayout=\"column\" fxLayoutAlign=\"center\">\n              <!--name-->\n              <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                              [appearance]=\"appearance\">\n                <!--labels will work only with @angular/material@6.2.0 -->\n                <mat-label>{{nameText}}</mat-label>\n                <input\n                  [formControl]=\"sigUpNameFormControl\"\n                  [maxlength]=\"config.nameMaxLength\"\n                  [minlength]=\"config.nameMinLength\"\n                  matInput\n                  required\n                />\n                <mat-icon [color]=\"color\" matSuffix>person</mat-icon>\n                <mat-hint align=\"end\" aria-live=\"polite\"> {{ signUpFormGroup.value.name?.length }}\n                  / {{ config.nameMaxLength }} </mat-hint>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('required')\">\n                  {{nameErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('minlength')\">\n                  {{nameErrorMinLengthText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('maxlength')\">\n                  {{nameErrorMaxLengthText}}\n                </mat-error>\n              </mat-form-field>\n\n              <!--email-->\n              <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{emailText}}</mat-label>\n                <input [formControl]=\"sigUpEmailFormControl\"\n                       matInput\n                       required\n                       type=\"email\">\n                <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n                <mat-error *ngIf=\"sigUpEmailFormControl.hasError('required')\">\n                  {{emailErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpEmailFormControl.hasError('pattern')\">\n                  {{emailErrorPatternText}}\n                </mat-error>\n              </mat-form-field>\n\n              <!--password-->\n              <div fxLayout=\"column\">\n                <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                                [appearance]=\"appearance\">\n                  <mat-label>{{passwordText}}</mat-label>\n                  <input\n                    [formControl]=\"sigUpPasswordFormControl\"\n                    [maxlength]=\"max\"\n                    [minlength]=\"min\"\n                    [type]=\"toggle.type\"\n                    matInput\n                    name=\"password\"\n                    required\n                  />\n                  <mat-pass-toggle-visibility #toggle matSuffix></mat-pass-toggle-visibility>\n\n                  <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n\n                  <mat-hint align=\"end\" aria-live=\"polite\">\n                    {{signUpFormGroup.value.password?.length}} / {{ max }}\n                  </mat-hint>\n\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('required')\" class=\"cut-text\">\n                    {{passwordErrorRequiredText}}\n                  </mat-error>\n\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('minlength')\" class=\"cut-text\">\n                    {{ passwordErrorMinLengthText }}\n                  </mat-error>\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('maxlength')\" class=\"cut-text\">\n                    {{ passwordErrorMaxLengthText }}\n                  </mat-error>\n\n                </mat-form-field>\n\n                <mat-password-strength #passwordStrength\n                                       [customValidator]=\"customValidator\"\n                                       [enableDigitRule]=\"enableDigitRule\"\n                                       [enableLengthRule]=\"enableLengthRule\"\n                                       [enableLowerCaseLetterRule]=\"enableLowerCaseLetterRule\"\n                                       [enableSpecialCharRule]=\"enableSpecialCharRule\"\n                                       [enableUpperCaseLetterRule]=\"enableUpperCaseLetterRule\"\n                                       [externalError]=\"sigUpPasswordFormControl.dirty\"\n                                       [max]=\"max\"\n                                       [min]=\"min\"\n                                       [password]=\"signUpFormGroup.value.password\">\n                </mat-password-strength>\n\n              </div>\n\n              <button [@animate]=\"{ value: '*', params: { x: '100px' } }\"\n                      [color]=\"color\"\n                      [disabled]=\"signUpFormGroup.invalid\"\n                      mat-raised-button\n                      style=\"margin-top: 20px\"\n                      type=\"submit\">\n                {{registerButtonText}}\n              </button>\n\n            </div>\n          </form>\n\n          <button (click)=\"processLegalSignUP(authProvider.ANONYMOUS)\"\n                  *ngIf=\"guestEnabled\"\n                  [@animate]=\"{ value: '*', params: { x: '-100px' } }\"\n                  [color]=\"color\"\n                  mat-button\n                  style=\"margin-top: 20px\">\n            <mat-icon>fingerprint</mat-icon>\n            {{guestButtonText}}\n          </button>\n\n        </mat-card-content>\n\n        <mat-card-footer *ngIf=\"isLoading\">\n          <mat-progress-bar [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n                            mode=\"indeterminate\"></mat-progress-bar>\n        </mat-card-footer>\n\n      </mat-card>\n    </mat-tab>\n\n    <!--Reset password tab-->\n    <mat-tab *ngIf=\"passwordResetWished\" class=\"reset-password-tab\">\n      <ng-template mat-tab-label>\n        <button (click)=\"passwordResetWished = false\" class=\"reset-password-tab__close-button\" mat-icon-button>\n          {{ resetPasswordTabText }}\n          <mat-icon>close</mat-icon>\n        </button>\n      </ng-template>\n      <form (ngSubmit)=\"resetPasswordFormGroup.valid && resetPassword()\"\n            [@animateStagger]=\"{ value: '50' }\"\n            [formGroup]=\"resetPasswordFormGroup\">\n        <mat-card class=\"reset-password-card\">\n          <mat-card-content>\n            <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\" [appearance]=\"appearance\"\n                            class=\"full-width\">\n              <mat-label> {{ resetPasswordInputText }} </mat-label>\n              <input [title]=\"resetPasswordInputText\"\n                     formControlName=\"email\"\n                     matInput\n                     required>\n              <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n              <mat-error *ngIf=\"resetPasswordEmailFormControl.hasError('required')\">\n                {{resetPasswordErrorRequiredText}}\n              </mat-error>\n              <mat-error *ngIf=\"resetPasswordEmailFormControl.hasError('pattern')\">\n                {{resetPasswordErrorPatternText}}\n              </mat-error>\n            </mat-form-field>\n            <p *ngIf=\"passReset\">{{resetPasswordInstructionsText}}</p>\n          </mat-card-content>\n          <mat-card-actions fxLayoutAlign=\"center\">\n            <mat-progress-bar *ngIf=\"isLoading\" mode=\"indeterminate\"></mat-progress-bar>\n            <button [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                    [color]=\"color\"\n                    mat-raised-button\n                    type=\"submit\">\n              {{resetPasswordActionButtonText}}\n            </button>\n          </mat-card-actions>\n        </mat-card>\n      </form>\n    </mat-tab>\n\n  </mat-tab-group>\n  <mat-divider></mat-divider>\n  <ngx-auth-firebaseui-providers *ngIf=\"tabIndex !== 2\"\n                                 [providers]=\"providers\"\n                                 [theme]=\"providersTheme\">\n  </ngx-auth-firebaseui-providers>\n</ng-template>\n",
        animations: NgxAuthFirebaseuiAnimations,
        changeDetection: ChangeDetectionStrategy.OnPush,
        styles: [".mat-card{margin:2rem}.space-top{margin-top:.5rem}.full-width{width:100%}.cut-text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.signed-in-container .account-circle{font-size:12rem;width:12rem;height:12rem}.signed-in-container img.account-circle{-o-object-fit:cover;object-fit:cover;border-radius:50%}.signed-in-container .sign-out-button{margin-top:2rem}.signed-in-container .user-display-name{margin-top:1rem}.signed-in-container .user-email{margin-top:-1rem}.signed-in-container .actions{margin-top:2rem}.signed-in-container .actions .action-button,.signed-in-container .actions mat-progress-bar{width:100%}.signed-in-container .actions .action-button{margin-top:1rem}.reset-password-tab mat-progress-bar{margin-bottom:1rem}.reset-password-tab__close-button{width:100%;display:flex;justify-content:space-between;align-items:center}.reset-password-tab__close-button mat-icon{font-size:18px;position:relative;top:-1px}"]
    }),
    __param(0, Inject(PLATFORM_ID)),
    __param(1, Inject(forwardRef(() => NgxAuthFirebaseUIConfigToken)))
], AuthComponent);
export { AuthComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtYXV0aC1maXJlYmFzZXVpLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbmd4LWF1dGgtZmlyZWJhc2V1aS9hdXRoLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDbEQsT0FBTyxFQUNMLGFBQWEsRUFDYix1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxZQUFZLEVBQ1osVUFBVSxFQUNWLE1BQU0sRUFDTixLQUFLLEVBQ0wsU0FBUyxFQUNULFNBQVMsRUFDVCxNQUFNLEVBQ04sTUFBTSxFQUNOLFdBQVcsRUFDWCxhQUFhLEVBQ2IsV0FBVyxFQUNYLFNBQVMsRUFDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFrQixXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBRW5GLG1CQUFtQjtBQUNuQixPQUFPLEVBQW9CLFdBQVcsRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBRXRFLE9BQU8sRUFBQyxTQUFTLEVBQUUsWUFBWSxFQUFDLE1BQU0sMEJBQTBCLENBQUM7QUFHakUsZUFBZTtBQUNmLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUVuRCxjQUFjO0FBQ2QsT0FBTyxFQUFDLDRCQUE0QixFQUFDLE1BQU0sZ0RBQWdELENBQUM7QUFLNUYsT0FBTyxFQUFDLHVCQUF1QixFQUFRLE1BQU0sSUFBSSxDQUFDO0FBRWxELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxZQUFZLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUN0RixPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsNEJB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c0I7QUFDckI7SUFBUixLQUFLLEVBQUU7NkRBQStDO0FBQzlDO0lBQVIsS0FBSyxFQUFFOzREQUErRDtBQUU5RDtJQUFSLEtBQUssRUFBRTttREFBMkI7QUFDMUI7SUFBUixLQUFLLEVBQUU7Z0VBQW9EO0FBQ25EO0lBQVIsS0FBSyxFQUFFO2lFQUEyRDtBQUMxRDtJQUFSLEtBQUssRUFBRTtpRUFBMEQ7QUFHekQ7SUFBUixLQUFLLEVBQUU7c0RBQThCO0FBQzdCO0lBQVIsS0FBSyxFQUFFOzREQUF3QztBQUN2QztJQUFSLEtBQUssRUFBRTt5REFBaUM7QUFDaEM7SUFBUixLQUFLLEVBQUU7c0RBQXVDO0FBR3RDO0lBQVIsS0FBSyxFQUFFOzZEQUF5RDtBQUV4RDtJQUFSLEtBQUssRUFBRTs0REFBa0s7QUE1Ri9KLGFBQWE7SUFQekIsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLHFCQUFxQjtRQUMvQiw4c2NBQWtDO1FBRWxDLFVBQVUsRUFBRSwyQkFBMkI7UUFDdkMsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07O0tBQ2hELENBQUM7SUF5SEcsV0FBQSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDbkIsV0FBQSxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLDRCQUE0QixDQUFDLENBQUMsQ0FBQTtHQXpIOUMsYUFBYSxDQXNWekI7U0F0VlksYUFBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNQbGF0Zm9ybUJyb3dzZXJ9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbXBvbmVudCxcbiAgRXZlbnRFbWl0dGVyLFxuICBmb3J3YXJkUmVmLFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFBMQVRGT1JNX0lELFxuICBTaW1wbGVDaGFuZ2VzLFxuICBUZW1wbGF0ZVJlZixcbiAgVmlld0NoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtBY3RpdmF0ZWRSb3V0ZX0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7QWJzdHJhY3RDb250cm9sLCBGb3JtQ29udHJvbCwgRm9ybUdyb3VwLCBWYWxpZGF0b3JzfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbi8vIEFOR1VMQVIgTUFURVJJQUxcbmltcG9ydCB7TWF0VGFiQ2hhbmdlRXZlbnQsIE1hdFRhYkdyb3VwfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC90YWJzJztcbmltcG9ydCB7VGhlbWVQYWxldHRlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9jb3JlJztcbmltcG9ydCB7TWF0RGlhbG9nLCBNYXREaWFsb2dSZWZ9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQge01hdEZvcm1GaWVsZEFwcGVhcmFuY2V9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2Zvcm0tZmllbGQnO1xuXG4vLyBBTkdVTEFSIEZJUkVcbmltcG9ydCB7QW5ndWxhckZpcmVBdXRofSBmcm9tICdAYW5ndWxhci9maXJlL2F1dGgnO1xuXG4vLyBUaGlyZCBQQVJUWVxuaW1wb3J0IHtNYXRQYXNzd29yZFN0cmVuZ3RoQ29tcG9uZW50fSBmcm9tICdAYW5ndWxhci1tYXRlcmlhbC1leHRlbnNpb25zL3Bhc3N3b3JkLXN0cmVuZ3RoJztcblxuLy8gUlhKU1xuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMvaW50ZXJuYWwvU3Vic2NyaXB0aW9uJztcblxuaW1wb3J0IHtMZWdhbGl0eURpYWxvZ0NvbXBvbmVudCwgVGhlbWV9IGZyb20gJy4uJztcbmltcG9ydCB7TGVnYWxpdHlEaWFsb2dQYXJhbXMsIExlZ2FsaXR5RGlhbG9nUmVzdWx0LCBOZ3hBdXRoRmlyZWJhc2VVSUNvbmZpZ30gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBBdXRoUHJvY2Vzc1NlcnZpY2UsIEF1dGhQcm92aWRlcn0gZnJvbSAnLi4vLi4vc2VydmljZXMvYXV0aC1wcm9jZXNzLnNlcnZpY2UnO1xuaW1wb3J0IHtOZ3hBdXRoRmlyZWJhc2V1aUFuaW1hdGlvbnN9IGZyb20gJy4uLy4uL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHtOZ3hBdXRoRmlyZWJhc2VVSUNvbmZpZ1Rva2VufSBmcm9tICcuLi8uLi90b2tlbnMnO1xuXG5cbmV4cG9ydCBjb25zdCBFTUFJTF9SRUdFWCA9IG5ldyBSZWdFeHAoWydeKChbXjw+KClbXFxcXF1cXFxcXFwuLDs6XFxcXHNAXFxcIl0rKFxcXFwuW148PigpXFxcXFtcXFxcXVxcXFxcXC4sOzpcXFxcc0BcXFwiXSspKiknLFxuICAnfChcIi4rXCIpKUAoKFxcXFxbWzAtOV17MSwzfVxcXFwuWzAtOV17MSwzfVxcXFwuWzAtOV17MSwzfVxcXFwuJyxcbiAgJ1swLTldezEsM31cXF0pfCgoW2EtekEtWlxcXFwtMC05XStcXFxcLikrJyxcbiAgJ1thLXpBLVpdezIsfSkpJCddLmpvaW4oJycpKTtcblxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuZXhwb3J0IGNvbnN0IFBIT05FX05VTUJFUl9SRUdFWCA9IG5ldyBSZWdFeHAoWydeWytdezAsMX1bKF17MCwxfVswLTldezEsNH1bKV17MCwxfVstXFxcXHNcXFxcLl17MCwxfVsoXXswLDF9WzAtOV17MSw0fVspXXswLDF9Wy1cXFxcc1xcXFwuLzAtOV17NCwxMn0kJ10uam9pbignJykpO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtYXV0aC1maXJlYmFzZXVpJyxcbiAgdGVtcGxhdGVVcmw6ICdhdXRoLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJ2F1dGguY29tcG9uZW50LnNjc3MnXSxcbiAgYW5pbWF0aW9uczogTmd4QXV0aEZpcmViYXNldWlBbmltYXRpb25zLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBBdXRoQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG5cbiAgQFZpZXdDaGlsZChNYXRUYWJHcm91cCwge3N0YXRpYzogZmFsc2V9KSBtYXRUYWJHcm91cDogTWF0VGFiR3JvdXA7XG4gIEBWaWV3Q2hpbGQoTWF0UGFzc3dvcmRTdHJlbmd0aENvbXBvbmVudCwge3N0YXRpYzogZmFsc2V9KSBwYXNzd29yZFN0cmVuZ3RoOiBNYXRQYXNzd29yZFN0cmVuZ3RoQ29tcG9uZW50O1xuXG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbiAgLy8gIGdvb2dsZSwgZmFjZWJvb2ssIHR3aXR0ZXIsIGdpdGh1YiBhcyBhcnJheSBvciBhbGwgYXMgb25lIHNpbmdsZSBzdHJpbmdcbiAgQElucHV0KCkgcHJvdmlkZXJzOiBBdXRoUHJvdmlkZXJbXSB8IEF1dGhQcm92aWRlciA9IEF1dGhQcm92aWRlci5BTEw7XG4gIEBJbnB1dCgpIHByb3ZpZGVyc1RoZW1lOiBUaGVtZTsgLy8gQ2xhc3NpYywgU3Ryb2tlZCwgZXRjLlxuXG4gIEBJbnB1dCgpIGFwcGVhcmFuY2U6IE1hdEZvcm1GaWVsZEFwcGVhcmFuY2U7XG4gIEBJbnB1dCgpIHRhYkluZGV4OiBudW1iZXIgfCBudWxsO1xuICBASW5wdXQoKSByZWdpc3RyYXRpb25FbmFibGVkID0gdHJ1ZTtcbiAgQElucHV0KCkgcmVzZXRQYXNzd29yZEVuYWJsZWQgPSB0cnVlO1xuICBASW5wdXQoKSBndWVzdEVuYWJsZWQgPSB0cnVlO1xuICBASW5wdXQoKSB0b3NVcmw6IHN0cmluZztcbiAgQElucHV0KCkgcHJpdmFjeVBvbGljeVVybDogc3RyaW5nO1xuICBASW5wdXQoKSBnb0JhY2tVUkw6IHN0cmluZztcbiAgQElucHV0KCkgbWVzc2FnZU9uQXV0aFN1Y2Nlc3M6IHN0cmluZztcbiAgQElucHV0KCkgbWVzc2FnZU9uQXV0aEVycm9yOiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1lc3NhZ2VPbkVtYWlsQ29uZmlybWF0aW9uU3VjY2Vzczogc3RyaW5nO1xuXG4gIC8vIEV2ZW50c1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KCkgb25TdWNjZXNzOiBhbnk7XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1vdXRwdXQtb24tcHJlZml4XG4gIEBPdXRwdXQoKSBvbkVycm9yOiBhbnk7XG4gIEBPdXRwdXQoKSBzZWxlY3RlZFRhYkNoYW5nZTogRXZlbnRFbWl0dGVyPE1hdFRhYkNoYW5nZUV2ZW50PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAvLyBQYXNzd29yZCBzdHJlbmd0aCBhcGlcbiAgQElucHV0KCkgZW5hYmxlTGVuZ3RoUnVsZSA9IHRydWU7XG4gIEBJbnB1dCgpIGVuYWJsZUxvd2VyQ2FzZUxldHRlclJ1bGUgPSB0cnVlO1xuICBASW5wdXQoKSBlbmFibGVVcHBlckNhc2VMZXR0ZXJSdWxlID0gdHJ1ZTtcbiAgQElucHV0KCkgZW5hYmxlRGlnaXRSdWxlID0gdHJ1ZTtcbiAgQElucHV0KCkgZW5hYmxlU3BlY2lhbENoYXJSdWxlID0gdHJ1ZTtcbiAgQElucHV0KCkgbWluOiBudW1iZXI7XG4gIEBJbnB1dCgpIG1heDogbnVtYmVyO1xuICBASW5wdXQoKSBjdXN0b21WYWxpZGF0b3I6IFJlZ0V4cDtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW91dHB1dC1vbi1wcmVmaXhcbiAgQE91dHB1dCgpIG9uU3RyZW5ndGhDaGFuZ2VkOiBFdmVudEVtaXR0ZXI8bnVtYmVyPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAvLyBWZXJpZnkgZW1haWwgdGVtcGxhdGUgdG8gdXNlIGluIHBsYWNlIG9mIGRlZmF1bHQgdGVtcGxhdGUuXG4gIC8vIFNlZSBlbWFpbC1jb25maXJtYXRpb24gY29tcG9uZW50XG4gIEBJbnB1dCgpIHZlcmlmeUVtYWlsVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgLy8gaTE4biB0cmFuc2xhdGlvbnMgdG8gdXNlIGluIGRlZmF1bHQgdGVtcGxhdGUgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbi5cbiAgLy8gU2VlIGVtYWlsLWNvbmZpcm1hdGlvbiBjb21wb25lbnRcbiAgQElucHV0KCkgdmVyaWZ5RW1haWxUaXRsZVRleHQ6IHN0cmluZztcbiAgQElucHV0KCkgdmVyaWZ5RW1haWxDb25maXJtYXRpb25UZXh0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIHZlcmlmeUVtYWlsR29CYWNrVGV4dCA9ICdHbyBiYWNrJztcbiAgQElucHV0KCkgc2VuZE5ld1ZlcmlmaWNhdGlvbkVtYWlsVGV4dDogc3RyaW5nO1xuICBASW5wdXQoKSBzaWduT3V0VGV4dCA9ICdTaWduIG91dCc7XG5cbiAgLy8gQ3VzdG9taXplIHRoZSB0ZXh0XG4gIC8vIFJlc2V0IFBhc3N3b3JkIFRhYlxuICBASW5wdXQoKSByZXNldFBhc3N3b3JkVGFiVGV4dCA9ICdSZXNldCBlLW1haWwgYWRkcmVzcyB0byBwYXNzd29yZCc7XG4gIEBJbnB1dCgpIHJlc2V0UGFzc3dvcmRJbnB1dFRleHQgPSAnUmVzZXQgZS1tYWlsIGFkZHJlc3MgdG8gcGFzc3dvcmQnO1xuICBASW5wdXQoKSByZXNldFBhc3N3b3JkRXJyb3JSZXF1aXJlZFRleHQgPSAnRS1tYWlsIGlzIHJlcXVpcmVkIHRvIHJlc2V0IHRoZSBwYXNzd29yZCEnO1xuICBASW5wdXQoKSByZXNldFBhc3N3b3JkRXJyb3JQYXR0ZXJuVGV4dCA9ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBlLW1haWwgYWRkcmVzcyc7XG4gIEBJbnB1dCgpIHJlc2V0UGFzc3dvcmRBY3Rpb25CdXR0b25UZXh0ID0gJ1Jlc2V0JztcbiAgQElucHV0KCkgcmVzZXRQYXNzd29yZEluc3RydWN0aW9uc1RleHQgPSAnUmVzZXQgcmVxdWVzdGVkLiBDaGVjayB5b3VyIGUtbWFpbCBpbnN0cnVjdGlvbnMuJztcblxuICAvLyBTaWduSW4gVGFiXG4gIEBJbnB1dCgpIHNpZ25JblRhYlRleHQgPSAnU2lnbiBpbic7XG4gIEBJbnB1dCgpIHNpZ25JbkNhcmRUaXRsZVRleHQgPSAnU2lnbmluZyBpbic7XG4gIEBJbnB1dCgpIGxvZ2luQnV0dG9uVGV4dCA9ICdMb2cgSW4nO1xuICBASW5wdXQoKSBmb3Jnb3RQYXNzd29yZEJ1dHRvblRleHQgPSAnRm9yZ290IFBhc3N3b3JkID8nO1xuXG4gIC8vIENvbW1vblxuICBASW5wdXQoKSBuYW1lVGV4dCA9ICdOYW1lJztcbiAgQElucHV0KCkgbmFtZUVycm9yUmVxdWlyZWRUZXh0ID0gJ05hbWUgaXMgcmVxdWlyZWQnO1xuICBASW5wdXQoKSBuYW1lRXJyb3JNaW5MZW5ndGhUZXh0ID0gJ1RoZSBuYW1lIGlzIHRvbyBzaG9ydCEnO1xuICBASW5wdXQoKSBuYW1lRXJyb3JNYXhMZW5ndGhUZXh0ID0gJ1RoZSBuYW1lIGlzIHRvbyBsb25nISc7XG5cbiAgQElucHV0KCkgZW1haWxUZXh0ID0gJ0UtbWFpbCc7XG4gIEBJbnB1dCgpIGVtYWlsRXJyb3JSZXF1aXJlZFRleHQgPSAnRS1tYWlsIGlzIHJlcXVpcmVkJztcbiAgQElucHV0KCkgZW1haWxFcnJvclBhdHRlcm5UZXh0ID0gJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGUtbWFpbCBhZGRyZXNzJztcblxuICBASW5wdXQoKSBwYXNzd29yZFRleHQgPSAnUGFzc3dvcmQnO1xuICBASW5wdXQoKSBwYXNzd29yZEVycm9yUmVxdWlyZWRUZXh0ID0gJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJztcbiAgQElucHV0KCkgcGFzc3dvcmRFcnJvck1pbkxlbmd0aFRleHQgPSAnVGhlIHBhc3N3b3JkIGlzIHRvbyBzaG9ydCEnO1xuICBASW5wdXQoKSBwYXNzd29yZEVycm9yTWF4TGVuZ3RoVGV4dCA9ICdUaGUgcGFzc3dvcmQgaXMgdG9vIGxvbmchJztcblxuICAvLyBSZWdpc3RlciBUYWJcbiAgQElucHV0KCkgcmVnaXN0ZXJUYWJUZXh0ID0gJ1JlZ2lzdGVyJztcbiAgQElucHV0KCkgcmVnaXN0ZXJDYXJkVGl0bGVUZXh0ID0gJ1JlZ2lzdHJhdGlvbic7XG4gIEBJbnB1dCgpIHJlZ2lzdGVyQnV0dG9uVGV4dCA9ICdSZWdpc3Rlcic7XG4gIEBJbnB1dCgpIGd1ZXN0QnV0dG9uVGV4dCA9ICdjb250aW51ZSBhcyBndWVzdCc7XG5cbiAgLy8gZW1haWwgY29uZmlybWF0aW9uIGNvbXBvbmVudFxuICBASW5wdXQoKSBlbWFpbENvbmZpcm1hdGlvblRpdGxlID0gJ0NvbmZpcm0geW91ciBlLW1haWwgYWRkcmVzcyEnO1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXG4gIEBJbnB1dCgpIGVtYWlsQ29uZmlybWF0aW9uVGV4dCA9IGBBIGNvbmZpcm1hdGlvbiBlLW1haWwgaGFzIGJlZW4gc2VudCB0byB5b3UuIENoZWNrIHlvdXIgaW5ib3ggYW5kIGNsaWNrIG9uIHRoZSBsaW5rIFwiQ29uZmlybSBteSBlLW1haWxcIiB0byBjb25maXJtIHlvdXIgZS1tYWlsIGFkZHJlc3MuYDtcblxuICBhdXRoUHJvdmlkZXIgPSBBdXRoUHJvdmlkZXI7XG4gIHBhc3N3b3JkUmVzZXRXaXNoZWQ6IGJvb2xlYW47XG5cbiAgcHVibGljIHNpZ25JbkZvcm1Hcm91cDogRm9ybUdyb3VwO1xuICBwdWJsaWMgc2lnblVwRm9ybUdyb3VwOiBGb3JtR3JvdXA7XG4gIHB1YmxpYyByZXNldFBhc3N3b3JkRm9ybUdyb3VwOiBGb3JtR3JvdXA7XG5cbiAgb25FcnJvclN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBhdXRoZW50aWNhdGlvbkVycm9yID0gZmFsc2U7XG5cbiAgcGFzc1Jlc2V0ID0gZmFsc2U7XG4gIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPExlZ2FsaXR5RGlhbG9nQ29tcG9uZW50PjtcblxuICBhdXRoUHJvdmlkZXJzID0gQXV0aFByb3ZpZGVyO1xuXG4gIHNpZ25JbkVtYWlsRm9ybUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcbiAgc2lnSW5QYXNzd29yZEZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG5cbiAgc2lnVXBOYW1lRm9ybUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcbiAgc2lnVXBFbWFpbEZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG4gIHNpZ1VwUGFzc3dvcmRGb3JtQ29udHJvbDogQWJzdHJhY3RDb250cm9sO1xuICBzaWdVcFBhc3N3b3JkQ29uZmlybWF0aW9uRm9ybUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcbiAgcmVzZXRQYXNzd29yZEVtYWlsRm9ybUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6YmFuLXR5cGVzXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybUlkOiBPYmplY3QsXG4gICAgQEluamVjdChmb3J3YXJkUmVmKCgpID0+IE5neEF1dGhGaXJlYmFzZVVJQ29uZmlnVG9rZW4pKSBwdWJsaWMgY29uZmlnOiBOZ3hBdXRoRmlyZWJhc2VVSUNvbmZpZyxcbiAgICBwdWJsaWMgYXV0aDogQW5ndWxhckZpcmVBdXRoLFxuICAgIHB1YmxpYyBhdXRoUHJvY2VzczogQXV0aFByb2Nlc3NTZXJ2aWNlLFxuICAgIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZyxcbiAgICBwcml2YXRlIGFjdGl2YXRlZFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICBwcml2YXRlIGNoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZlxuICApIHtcbiAgICB0aGlzLm9uU3VjY2VzcyA9IGF1dGhQcm9jZXNzLm9uU3VjY2Vzc0VtaXR0ZXI7XG4gICAgdGhpcy5vbkVycm9yID0gYXV0aFByb2Nlc3Mub25FcnJvckVtaXR0ZXI7XG4gIH1cblxuICBnZXQgY29sb3IoKTogc3RyaW5nIHwgVGhlbWVQYWxldHRlIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoZW50aWNhdGlvbkVycm9yID8gJ3dhcm4nIDogJ3ByaW1hcnknO1xuICB9XG5cbiAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XG4gICAgICB0aGlzLm9uRXJyb3JTdWJzY3JpcHRpb24gPSB0aGlzLm9uRXJyb3Iuc3Vic2NyaWJlKCgpID0+IHRoaXMuYXV0aGVudGljYXRpb25FcnJvciA9IHRydWUpO1xuICAgIH1cbiAgICB0aGlzLm1pbiA9IHRoaXMubWluICE9IG51bGwgPyBNYXRoLm1heCh0aGlzLm1pbiwgdGhpcy5jb25maWcucGFzc3dvcmRNaW5MZW5ndGgpIDogdGhpcy5jb25maWcucGFzc3dvcmRNaW5MZW5ndGg7XG4gICAgdGhpcy5tYXggPSB0aGlzLm1heCAhPSBudWxsID8gTWF0aC5taW4odGhpcy5tYXgsIHRoaXMuY29uZmlnLnBhc3N3b3JkTWF4TGVuZ3RoKSA6IHRoaXMuY29uZmlnLnBhc3N3b3JkTWF4TGVuZ3RoO1xuXG4gICAgdGhpcy5nb0JhY2tVUkwgPSB0aGlzLmNob29zZUJhY2tVcmwoKTtcblxuICAgIHRoaXMudXBkYXRlQXV0aFNuYWNrYmFyTWVzc2FnZXMoKTtcbiAgICAvLyBhdXRoIGZvcm0ncyBpbml0aWFsaXphdGlvblxuICAgIHRoaXMuX2luaXRTaWduSW5Gb3JtR3JvdXBCdWlsZGVyKCk7XG4gICAgdGhpcy5faW5pdFNpZ25VcEZvcm1Hcm91cEJ1aWxkZXIoKTtcbiAgICB0aGlzLl9pbml0UmVzZXRQYXNzd29yZEZvcm1Hcm91cEJ1aWxkZXIoKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wYXNzd29yZFN0cmVuZ3RoKSB7XG4gICAgICB0aGlzLnBhc3N3b3JkU3RyZW5ndGgub25TdHJlbmd0aENoYW5nZWQuc3Vic2NyaWJlKChzdHJlbmd0aDogbnVtYmVyKSA9PiB7XG4gICAgICAgIHRoaXMub25TdHJlbmd0aENoYW5nZWQuZW1pdChzdHJlbmd0aCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgaWYgKGNoYW5nZXMubWVzc2FnZU9uQXV0aFN1Y2Nlc3MgfHwgY2hhbmdlcy5tZXNzYWdlT25BdXRoRXJyb3IpIHtcbiAgICAgIHRoaXMudXBkYXRlQXV0aFNuYWNrYmFyTWVzc2FnZXMoKTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXMubWluKSB7XG4gICAgICB0aGlzLm1pbiA9IHRoaXMubWluICE9IG51bGwgPyBNYXRoLm1heCh0aGlzLm1pbiwgdGhpcy5jb25maWcucGFzc3dvcmRNaW5MZW5ndGgpIDogdGhpcy5jb25maWcucGFzc3dvcmRNaW5MZW5ndGg7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzLm1heCkge1xuICAgICAgdGhpcy5tYXggPSB0aGlzLm1heCAhPSBudWxsID8gTWF0aC5taW4odGhpcy5tYXgsIHRoaXMuY29uZmlnLnBhc3N3b3JkTWF4TGVuZ3RoKSA6IHRoaXMuY29uZmlnLnBhc3N3b3JkTWF4TGVuZ3RoO1xuICAgIH1cbiAgICBpZiAoY2hhbmdlcy5nb0JhY2tVUkwpIHtcbiAgICAgIHRoaXMuZ29CYWNrVVJMID0gdGhpcy5jaG9vc2VCYWNrVXJsKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgaWYgKHRoaXMub25FcnJvclN1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5vbkVycm9yU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgb25UYWJDaGFuZ2UoZXZlbnQ6IE1hdFRhYkNoYW5nZUV2ZW50KSB7XG4gICAgdGhpcy5zZWxlY3RlZFRhYkNoYW5nZS5lbWl0KGV2ZW50KTtcbiAgICB0aGlzLnRhYkluZGV4ID0gZXZlbnQuaW5kZXg7XG4gIH1cblxuICBhc3luYyBzaWduT3V0KCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduT3V0KCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLnRhYkluZGV4ID0gMDtcbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2lnbkluKCkge1xuICAgIGlmICghdGhpcy5zaWduSW5Gb3JtR3JvdXAudmFsaWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICBhd2FpdCB0aGlzLmF1dGhQcm9jZXNzLnNpZ25JbldpdGgodGhpcy5hdXRoUHJvdmlkZXJzLkVtYWlsQW5kUGFzc3dvcmQsIHtcbiAgICAgICAgZW1haWw6IHRoaXMuc2lnbkluRm9ybUdyb3VwLnZhbHVlLmVtYWlsLFxuICAgICAgICBwYXNzd29yZDogdGhpcy5zaWduSW5Gb3JtR3JvdXAudmFsdWUucGFzc3dvcmRcbiAgICAgIH0pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVBdXRoU25hY2tiYXJNZXNzYWdlcygpOiB2b2lkIHtcbiAgICB0aGlzLmF1dGhQcm9jZXNzLm1lc3NhZ2VPbkF1dGhTdWNjZXNzID0gdGhpcy5tZXNzYWdlT25BdXRoU3VjY2VzcztcbiAgICB0aGlzLmF1dGhQcm9jZXNzLm1lc3NhZ2VPbkF1dGhFcnJvciA9IHRoaXMubWVzc2FnZU9uQXV0aEVycm9yO1xuICB9XG5cbiAgY3JlYXRlRm9yZ290UGFzc3dvcmRUYWIoKSB7XG4gICAgdGhpcy5wYXNzd29yZFJlc2V0V2lzaGVkID0gdHJ1ZTtcbiAgICB0aGlzLnRhYkluZGV4ID0gMjtcbiAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICB9XG5cbiAgcHJvY2Vzc0xlZ2FsU2lnblVQKGF1dGhQcm92aWRlcj86IEF1dGhQcm92aWRlcikge1xuICAgIGlmICh0aGlzLnRvc1VybCB8fCB0aGlzLnByaXZhY3lQb2xpY3lVcmwpIHtcbiAgICAgIGNvbnN0IHBhcmFtczogTGVnYWxpdHlEaWFsb2dQYXJhbXMgPSB7XG4gICAgICAgIHRvc1VybDogdGhpcy50b3NVcmwsXG4gICAgICAgIHByaXZhY3lQb2xpY3lVcmw6IHRoaXMucHJpdmFjeVBvbGljeVVybCxcbiAgICAgICAgYXV0aFByb3ZpZGVyXG4gICAgICB9O1xuXG4gICAgICB0aGlzLmRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oTGVnYWxpdHlEaWFsb2dDb21wb25lbnQsIHtkYXRhOiBwYXJhbXN9KTtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKChyZXN1bHQ6IExlZ2FsaXR5RGlhbG9nUmVzdWx0KSA9PiB7XG4gICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LmNoZWNrZWQpIHtcbiAgICAgICAgICB0aGlzLl9hZnRlclNpZ25VcE1pZGRsZXdhcmUocmVzdWx0LmF1dGhQcm92aWRlcikudGhlbigoKSA9PiB0aGlzLnNpZ25VcEZvcm1Hcm91cC5yZXNldCgpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpYWxvZ1JlZiA9IG51bGw7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYWZ0ZXJTaWduVXBNaWRkbGV3YXJlKGF1dGhQcm92aWRlcikudGhlbigoKSA9PiB0aGlzLnNpZ25VcEZvcm1Hcm91cC5yZXNldCgpKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzaWduVXAoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduVXAoXG4gICAgICAgIHRoaXMuc2lnblVwRm9ybUdyb3VwLnZhbHVlLm5hbWUsXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogdGhpcy5zaWduVXBGb3JtR3JvdXAudmFsdWUuZW1haWwsXG4gICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuc2lnblVwRm9ybUdyb3VwLnZhbHVlLnBhc3N3b3JkXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNpZ25VcEFub255bW91c2x5KCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduSW5XaXRoKHRoaXMuYXV0aFByb3ZpZGVyLkFOT05ZTU9VUyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG5cbiAgcmVzZXRQYXNzd29yZCgpIHtcbiAgICB0aGlzLmF1dGhQcm9jZXNzLnJlc2V0UGFzc3dvcmQodGhpcy5yZXNldFBhc3N3b3JkRW1haWxGb3JtQ29udHJvbC52YWx1ZSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdGhpcy5wYXNzUmVzZXQgPSB0cnVlO1xuICAgICAgICAvLyB0aGlzLnRhYkluZGV4ID0gMjtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjaG9vc2VCYWNrVXJsKCkge1xuICAgIHJldHVybiB0aGlzLmFjdGl2YXRlZFJvdXRlLnNuYXBzaG90LnF1ZXJ5UGFyYW1zLnJlZGlyZWN0VXJsIHx8IHRoaXMuZ29CYWNrVVJMIHx8ICcvJztcbiAgfVxuXG4gIHByaXZhdGUgX2luaXRTaWduSW5Gb3JtR3JvdXBCdWlsZGVyKCkge1xuICAgIHRoaXMuc2lnbkluRm9ybUdyb3VwID0gbmV3IEZvcm1Hcm91cCh7fSk7XG4gICAgdGhpcy5zaWduSW5Gb3JtR3JvdXAucmVnaXN0ZXJDb250cm9sKCdlbWFpbCcsIHRoaXMuc2lnbkluRW1haWxGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgIFtcbiAgICAgICAgVmFsaWRhdG9ycy5yZXF1aXJlZCxcbiAgICAgICAgVmFsaWRhdG9ycy5wYXR0ZXJuKEVNQUlMX1JFR0VYKVxuICAgICAgXSkpO1xuICAgIHRoaXMuc2lnbkluRm9ybUdyb3VwLnJlZ2lzdGVyQ29udHJvbCgncGFzc3dvcmQnLCB0aGlzLnNpZ0luUGFzc3dvcmRGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgIFtcbiAgICAgICAgVmFsaWRhdG9ycy5yZXF1aXJlZCxcbiAgICAgICAgVmFsaWRhdG9ycy5taW5MZW5ndGgodGhpcy5taW4pLFxuICAgICAgICBWYWxpZGF0b3JzLm1heExlbmd0aCh0aGlzLm1heClcbiAgICAgIF0pKTtcbiAgfVxuXG4gIHByaXZhdGUgX2luaXRTaWduVXBGb3JtR3JvdXBCdWlsZGVyKCkge1xuICAgIHRoaXMuc2lnblVwRm9ybUdyb3VwID0gbmV3IEZvcm1Hcm91cCh7XG4gICAgICBuYW1lOiB0aGlzLnNpZ1VwTmFtZUZvcm1Db250cm9sID0gbmV3IEZvcm1Db250cm9sKCcnLFxuICAgICAgICBbXG4gICAgICAgICAgVmFsaWRhdG9ycy5yZXF1aXJlZCxcbiAgICAgICAgICBWYWxpZGF0b3JzLm1pbkxlbmd0aCh0aGlzLmNvbmZpZy5uYW1lTWluTGVuZ3RoKSxcbiAgICAgICAgICBWYWxpZGF0b3JzLm1heExlbmd0aCh0aGlzLmNvbmZpZy5uYW1lTWF4TGVuZ3RoKVxuICAgICAgICBdKSxcbiAgICAgIGVtYWlsOiB0aGlzLnNpZ1VwRW1haWxGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgICAgW1xuICAgICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgICAgVmFsaWRhdG9ycy5wYXR0ZXJuKEVNQUlMX1JFR0VYKVxuICAgICAgICBdKSxcbiAgICAgIHBhc3N3b3JkOiB0aGlzLnNpZ1VwUGFzc3dvcmRGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgICAgW1xuICAgICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgICAgVmFsaWRhdG9ycy5taW5MZW5ndGgodGhpcy5taW4pLFxuICAgICAgICAgIFZhbGlkYXRvcnMubWF4TGVuZ3RoKHRoaXMubWF4KSxcbiAgICAgICAgXSlcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2luaXRSZXNldFBhc3N3b3JkRm9ybUdyb3VwQnVpbGRlcigpIHtcbiAgICB0aGlzLnJlc2V0UGFzc3dvcmRGb3JtR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgIGVtYWlsOiB0aGlzLnJlc2V0UGFzc3dvcmRFbWFpbEZvcm1Db250cm9sID0gbmV3IEZvcm1Db250cm9sKCcnLFxuICAgICAgICBbXG4gICAgICAgICAgVmFsaWRhdG9ycy5yZXF1aXJlZCxcbiAgICAgICAgICBWYWxpZGF0b3JzLnBhdHRlcm4oRU1BSUxfUkVHRVgpXG4gICAgICAgIF0pXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9hZnRlclNpZ25VcE1pZGRsZXdhcmUoYXV0aFByb3ZpZGVyPzogQXV0aFByb3ZpZGVyKSB7XG4gICAgaWYgKGF1dGhQcm92aWRlciA9PT0gdGhpcy5hdXRoUHJvdmlkZXIuQU5PTllNT1VTKSB7XG4gICAgICByZXR1cm4gdGhpcy5zaWduVXBBbm9ueW1vdXNseSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zaWduVXAoKTtcbiAgfVxuXG59XG4iXX0=