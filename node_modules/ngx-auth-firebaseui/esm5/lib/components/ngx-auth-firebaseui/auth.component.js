import { __awaiter, __decorate, __generator, __param } from "tslib";
import { isPlatformBrowser } from '@angular/common';
import { AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, EventEmitter, forwardRef, Inject, Input, OnChanges, OnDestroy, OnInit, Output, PLATFORM_ID, SimpleChanges, TemplateRef, ViewChild } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { FormControl, FormGroup, Validators } from '@angular/forms';
// ANGULAR MATERIAL
import { MatTabGroup } from '@angular/material/tabs';
import { MatDialog, MatDialogRef } from '@angular/material/dialog';
// ANGULAR FIRE
import { AngularFireAuth } from '@angular/fire/auth';
// Third PARTY
import { MatPasswordStrengthComponent } from '@angular-material-extensions/password-strength';
import { LegalityDialogComponent } from '..';
import { AuthProcessService, AuthProvider } from '../../services/auth-process.service';
import { NgxAuthFirebaseuiAnimations } from '../../animations';
import { NgxAuthFirebaseUIConfigToken } from '../../tokens';
export var EMAIL_REGEX = new RegExp(['^(([^<>()[\\]\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\.,;:\\s@\"]+)*)',
    '|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.',
    '[0-9]{1,3}\])|(([a-zA-Z\\-0-9]+\\.)+',
    '[a-zA-Z]{2,}))$'].join(''));
// tslint:disable-next-line:max-line-length
export var PHONE_NUMBER_REGEX = new RegExp(['^[+]{0,1}[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\.]{0,1}[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\./0-9]{4,12}$'].join(''));
var AuthComponent = /** @class */ (function () {
    function AuthComponent(
    // tslint:disable-next-line:ban-types
    platformId, config, auth, authProcess, dialog, activatedRoute, changeDetectorRef) {
        this.platformId = platformId;
        this.config = config;
        this.auth = auth;
        this.authProcess = authProcess;
        this.dialog = dialog;
        this.activatedRoute = activatedRoute;
        this.changeDetectorRef = changeDetectorRef;
        //  google, facebook, twitter, github as array or all as one single string
        this.providers = AuthProvider.ALL;
        this.registrationEnabled = true;
        this.resetPasswordEnabled = true;
        this.guestEnabled = true;
        this.selectedTabChange = new EventEmitter();
        // Password strength api
        this.enableLengthRule = true;
        this.enableLowerCaseLetterRule = true;
        this.enableUpperCaseLetterRule = true;
        this.enableDigitRule = true;
        this.enableSpecialCharRule = true;
        // tslint:disable-next-line:no-output-on-prefix
        this.onStrengthChanged = new EventEmitter();
        this.verifyEmailGoBackText = 'Go back';
        this.signOutText = 'Sign out';
        // Customize the text
        // Reset Password Tab
        this.resetPasswordTabText = 'Reset e-mail address to password';
        this.resetPasswordInputText = 'Reset e-mail address to password';
        this.resetPasswordErrorRequiredText = 'E-mail is required to reset the password!';
        this.resetPasswordErrorPatternText = 'Please enter a valid e-mail address';
        this.resetPasswordActionButtonText = 'Reset';
        this.resetPasswordInstructionsText = 'Reset requested. Check your e-mail instructions.';
        // SignIn Tab
        this.signInTabText = 'Sign in';
        this.signInCardTitleText = 'Signing in';
        this.loginButtonText = 'Log In';
        this.forgotPasswordButtonText = 'Forgot Password ?';
        // Common
        this.nameText = 'Name';
        this.nameErrorRequiredText = 'Name is required';
        this.nameErrorMinLengthText = 'The name is too short!';
        this.nameErrorMaxLengthText = 'The name is too long!';
        this.emailText = 'E-mail';
        this.emailErrorRequiredText = 'E-mail is required';
        this.emailErrorPatternText = 'Please enter a valid e-mail address';
        this.passwordText = 'Password';
        this.passwordErrorRequiredText = 'Password is required';
        this.passwordErrorMinLengthText = 'The password is too short!';
        this.passwordErrorMaxLengthText = 'The password is too long!';
        // Register Tab
        this.registerTabText = 'Register';
        this.registerCardTitleText = 'Registration';
        this.registerButtonText = 'Register';
        this.guestButtonText = 'continue as guest';
        // email confirmation component
        this.emailConfirmationTitle = 'Confirm your e-mail address!';
        // tslint:disable-next-line:max-line-length
        this.emailConfirmationText = "A confirmation e-mail has been sent to you. Check your inbox and click on the link \"Confirm my e-mail\" to confirm your e-mail address.";
        this.authProvider = AuthProvider;
        this.authenticationError = false;
        this.passReset = false;
        this.authProviders = AuthProvider;
        this.onSuccess = authProcess.onSuccessEmitter;
        this.onError = authProcess.onErrorEmitter;
    }
    Object.defineProperty(AuthComponent.prototype, "color", {
        get: function () {
            return this.authenticationError ? 'warn' : 'primary';
        },
        enumerable: true,
        configurable: true
    });
    AuthComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (isPlatformBrowser(this.platformId)) {
            this.onErrorSubscription = this.onError.subscribe(function () { return _this.authenticationError = true; });
        }
        this.min = this.min != null ? Math.max(this.min, this.config.passwordMinLength) : this.config.passwordMinLength;
        this.max = this.max != null ? Math.min(this.max, this.config.passwordMaxLength) : this.config.passwordMaxLength;
        this.goBackURL = this.chooseBackUrl();
        this.updateAuthSnackbarMessages();
        // auth form's initialization
        this._initSignInFormGroupBuilder();
        this._initSignUpFormGroupBuilder();
        this._initResetPasswordFormGroupBuilder();
    };
    AuthComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        if (this.passwordStrength) {
            this.passwordStrength.onStrengthChanged.subscribe(function (strength) {
                _this.onStrengthChanged.emit(strength);
            });
        }
    };
    AuthComponent.prototype.ngOnChanges = function (changes) {
        if (changes.messageOnAuthSuccess || changes.messageOnAuthError) {
            this.updateAuthSnackbarMessages();
        }
        if (changes.min) {
            this.min = this.min != null ? Math.max(this.min, this.config.passwordMinLength) : this.config.passwordMinLength;
        }
        if (changes.max) {
            this.max = this.max != null ? Math.min(this.max, this.config.passwordMaxLength) : this.config.passwordMaxLength;
        }
        if (changes.goBackURL) {
            this.goBackURL = this.chooseBackUrl();
        }
    };
    AuthComponent.prototype.ngOnDestroy = function () {
        if (this.onErrorSubscription) {
            this.onErrorSubscription.unsubscribe();
        }
    };
    AuthComponent.prototype.onTabChange = function (event) {
        this.selectedTabChange.emit(event);
        this.tabIndex = event.index;
    };
    AuthComponent.prototype.signOut = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, , 2, 3]);
                        this.isLoading = true;
                        this.changeDetectorRef.markForCheck();
                        return [4 /*yield*/, this.authProcess.signOut()];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        this.isLoading = false;
                        this.tabIndex = 0;
                        this.changeDetectorRef.markForCheck();
                        return [7 /*endfinally*/];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    AuthComponent.prototype.signIn = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.signInFormGroup.valid) {
                            return [2 /*return*/];
                        }
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        this.isLoading = true;
                        this.changeDetectorRef.markForCheck();
                        return [4 /*yield*/, this.authProcess.signInWith(this.authProviders.EmailAndPassword, {
                                email: this.signInFormGroup.value.email,
                                password: this.signInFormGroup.value.password
                            })];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.isLoading = false;
                        this.changeDetectorRef.markForCheck();
                        return [7 /*endfinally*/];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    AuthComponent.prototype.updateAuthSnackbarMessages = function () {
        this.authProcess.messageOnAuthSuccess = this.messageOnAuthSuccess;
        this.authProcess.messageOnAuthError = this.messageOnAuthError;
    };
    AuthComponent.prototype.createForgotPasswordTab = function () {
        this.passwordResetWished = true;
        this.tabIndex = 2;
        this.changeDetectorRef.markForCheck();
    };
    AuthComponent.prototype.processLegalSignUP = function (authProvider) {
        var _this = this;
        if (this.tosUrl || this.privacyPolicyUrl) {
            var params = {
                tosUrl: this.tosUrl,
                privacyPolicyUrl: this.privacyPolicyUrl,
                authProvider: authProvider
            };
            this.dialogRef = this.dialog.open(LegalityDialogComponent, { data: params });
            this.dialogRef.afterClosed().subscribe(function (result) {
                if (result && result.checked) {
                    _this._afterSignUpMiddleware(result.authProvider).then(function () { return _this.signUpFormGroup.reset(); });
                }
                _this.dialogRef = null;
            });
        }
        else {
            this._afterSignUpMiddleware(authProvider).then(function () { return _this.signUpFormGroup.reset(); });
        }
    };
    AuthComponent.prototype.signUp = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, , 2, 3]);
                        this.isLoading = true;
                        this.changeDetectorRef.markForCheck();
                        return [4 /*yield*/, this.authProcess.signUp(this.signUpFormGroup.value.name, {
                                email: this.signUpFormGroup.value.email,
                                password: this.signUpFormGroup.value.password
                            })];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2:
                        this.isLoading = false;
                        this.changeDetectorRef.markForCheck();
                        return [7 /*endfinally*/];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    AuthComponent.prototype.signUpAnonymously = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, , 2, 3]);
                        this.isLoading = true;
                        this.changeDetectorRef.markForCheck();
                        return [4 /*yield*/, this.authProcess.signInWith(this.authProvider.ANONYMOUS)];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        this.isLoading = false;
                        this.changeDetectorRef.markForCheck();
                        return [7 /*endfinally*/];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    AuthComponent.prototype.resetPassword = function () {
        var _this = this;
        this.authProcess.resetPassword(this.resetPasswordEmailFormControl.value)
            .then(function () {
            _this.passReset = true;
            // this.tabIndex = 2;
            _this.changeDetectorRef.markForCheck();
        });
    };
    AuthComponent.prototype.chooseBackUrl = function () {
        return this.activatedRoute.snapshot.queryParams.redirectUrl || this.goBackURL || '/';
    };
    AuthComponent.prototype._initSignInFormGroupBuilder = function () {
        this.signInFormGroup = new FormGroup({});
        this.signInFormGroup.registerControl('email', this.signInEmailFormControl = new FormControl('', [
            Validators.required,
            Validators.pattern(EMAIL_REGEX)
        ]));
        this.signInFormGroup.registerControl('password', this.sigInPasswordFormControl = new FormControl('', [
            Validators.required,
            Validators.minLength(this.min),
            Validators.maxLength(this.max)
        ]));
    };
    AuthComponent.prototype._initSignUpFormGroupBuilder = function () {
        this.signUpFormGroup = new FormGroup({
            name: this.sigUpNameFormControl = new FormControl('', [
                Validators.required,
                Validators.minLength(this.config.nameMinLength),
                Validators.maxLength(this.config.nameMaxLength)
            ]),
            email: this.sigUpEmailFormControl = new FormControl('', [
                Validators.required,
                Validators.pattern(EMAIL_REGEX)
            ]),
            password: this.sigUpPasswordFormControl = new FormControl('', [
                Validators.required,
                Validators.minLength(this.min),
                Validators.maxLength(this.max),
            ])
        });
    };
    AuthComponent.prototype._initResetPasswordFormGroupBuilder = function () {
        this.resetPasswordFormGroup = new FormGroup({
            email: this.resetPasswordEmailFormControl = new FormControl('', [
                Validators.required,
                Validators.pattern(EMAIL_REGEX)
            ])
        });
    };
    AuthComponent.prototype._afterSignUpMiddleware = function (authProvider) {
        if (authProvider === this.authProvider.ANONYMOUS) {
            return this.signUpAnonymously();
        }
        return this.signUp();
    };
    AuthComponent.ctorParameters = function () { return [
        { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [forwardRef(function () { return NgxAuthFirebaseUIConfigToken; }),] }] },
        { type: AngularFireAuth },
        { type: AuthProcessService },
        { type: MatDialog },
        { type: ActivatedRoute },
        { type: ChangeDetectorRef }
    ]; };
    __decorate([
        ViewChild(MatTabGroup, { static: false })
    ], AuthComponent.prototype, "matTabGroup", void 0);
    __decorate([
        ViewChild(MatPasswordStrengthComponent, { static: false })
    ], AuthComponent.prototype, "passwordStrength", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "providers", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "providersTheme", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "appearance", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "tabIndex", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "registrationEnabled", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordEnabled", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "guestEnabled", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "tosUrl", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "privacyPolicyUrl", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "goBackURL", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "messageOnAuthSuccess", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "messageOnAuthError", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "messageOnEmailConfirmationSuccess", void 0);
    __decorate([
        Output()
    ], AuthComponent.prototype, "onSuccess", void 0);
    __decorate([
        Output()
    ], AuthComponent.prototype, "onError", void 0);
    __decorate([
        Output()
    ], AuthComponent.prototype, "selectedTabChange", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "enableLengthRule", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "enableLowerCaseLetterRule", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "enableUpperCaseLetterRule", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "enableDigitRule", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "enableSpecialCharRule", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "min", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "max", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "customValidator", void 0);
    __decorate([
        Output()
    ], AuthComponent.prototype, "onStrengthChanged", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "verifyEmailTemplate", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "verifyEmailTitleText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "verifyEmailConfirmationText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "verifyEmailGoBackText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "sendNewVerificationEmailText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "signOutText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordTabText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordInputText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordErrorRequiredText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordErrorPatternText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordActionButtonText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "resetPasswordInstructionsText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "signInTabText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "signInCardTitleText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "loginButtonText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "forgotPasswordButtonText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "nameText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "nameErrorRequiredText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "nameErrorMinLengthText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "nameErrorMaxLengthText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "emailText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "emailErrorRequiredText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "emailErrorPatternText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "passwordText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "passwordErrorRequiredText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "passwordErrorMinLengthText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "passwordErrorMaxLengthText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "registerTabText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "registerCardTitleText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "registerButtonText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "guestButtonText", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "emailConfirmationTitle", void 0);
    __decorate([
        Input()
    ], AuthComponent.prototype, "emailConfirmationText", void 0);
    AuthComponent = __decorate([
        Component({
            selector: 'ngx-auth-firebaseui',
            template: "<ng-container *ngIf=\"authProcess.user$ | async as user; else showForm\">\n\n  <!-- This component will be shown when:\n    - we just sent a verification mail (notably after sign up)\n    - we arrived from the guard after trying to access a protected route even though we are connected\n  -->\n  <div\n    *ngIf=\"(config.guardProtectedRoutesUntilEmailIsVerified && !user.emailVerified) || (authProcess.emailConfirmationSent && !user.emailVerified); else signedInUser\"\n    fxLayout=\"row\" fxLayoutAlign=\"center center\">\n    <ngx-auth-firebaseui-email-confirmation\n      (signOut)=\"signOut()\"\n      [email]=\"user.email\"\n      [goBackURL]=\"goBackURL\"\n      [messageOnEmailConfirmationSuccess]=\"messageOnEmailConfirmationSuccess\"\n      [sendNewVerificationEmailText]=\"sendNewVerificationEmailText\"\n      [signOutText]=\"signOutText\"\n      [template]=\"verifyEmailTemplate\"\n      [verifyEmailConfirmationText]=\"verifyEmailConfirmationText\"\n      [verifyEmailGoBackText]=\"verifyEmailGoBackText\"\n      [verifyEmailTitleText]=\"verifyEmailTitleText\">\n    </ngx-auth-firebaseui-email-confirmation>\n  </div>\n\n  <ng-template #signedInUser>\n    <div class=\"signed-in-container\" fxLayout=\"column\" fxLayoutAlign=\"center center\">\n      <img *ngIf=\"user?.photoURL; else noPhoto\" [src]=\"user?.photoURL\" class=\"account-circle\">\n      <ng-template #noPhoto>\n        <mat-icon class=\"account-circle\">account_circle</mat-icon>\n      </ng-template>\n      <div class=\"user-display-name mat-title\">{{ user?.displayName }}</div>\n      <div class=\"user-email mat-body-2\">{{ user?.email }}</div>\n      <div class=\"actions\">\n        <mat-progress-bar *ngIf=\"isLoading\" mode=\"indeterminate\"></mat-progress-bar>\n        <a [routerLink]=\"goBackURL\" class=\"go-back-button action-button\" color=\"primary\"\n           mat-stroked-button>{{ verifyEmailGoBackText }}</a>\n        <button (click)=\"signOut()\" class=\"sign-out-button action-button\" color=\"warn\"\n                mat-stroked-button>{{ signOutText }}</button>\n      </div>\n    </div>\n  </ng-template>\n\n</ng-container>\n\n<ng-template #showForm>\n  <mat-tab-group (selectedTabChange)=\"onTabChange($event)\" [color]=\"color\" [selectedIndex]=\"tabIndex\">\n    <!--Sign in tab-->\n    <mat-tab [label]=\"signInTabText\">\n      <mat-card>\n        <mat-card-title>{{signInCardTitleText}}</mat-card-title>\n        <mat-card-content>\n          <form (ngSubmit)=\"signIn()\"\n                [@animateStagger]=\"{ value: '50' }\"\n                [formGroup]=\"signInFormGroup\">\n            <div fxLayout=\"column\" fxLayoutAlign=\"center\">\n              <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{emailText}}</mat-label>\n                <input formControlName=\"email\"\n                       matInput\n                       required>\n                <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n                <mat-error *ngIf=\"signInEmailFormControl.hasError('required')\">\n                  {{emailErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"signInEmailFormControl.hasError('pattern')\">\n                  {{emailErrorPatternText}}\n                </mat-error>\n              </mat-form-field>\n\n              <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{passwordText}}</mat-label>\n                <input [maxlength]=\"max\" [minlength]=\"min\" [type]=\"togglePass.type\" formControlName=\"password\" matInput\n                       required/>\n                <mat-pass-toggle-visibility #togglePass matSuffix></mat-pass-toggle-visibility>\n                <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n                <mat-hint align=\"end\" aria-live=\"polite\"> {{ signInFormGroup.value.password.length }}\n                  / {{ max }} </mat-hint>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('required')\">\n                  {{passwordErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('minlength')\">\n                  {{ passwordErrorMinLengthText }}\n                </mat-error>\n                <mat-error *ngIf=\"sigInPasswordFormControl.hasError('maxlength')\">\n                  {{ passwordErrorMaxLengthText }}\n                </mat-error>\n              </mat-form-field>\n\n              <button [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                      [color]=\"color\"\n                      [disabled]=\"signInFormGroup.invalid\"\n                      class=\"space-top\"\n                      mat-raised-button\n                      style=\"margin-top: 20px\"\n                      type=\"submit\">\n                {{loginButtonText}}\n              </button>\n\n            </div>\n          </form>\n\n          <div fxLayoutAlign=\"center\">\n            <button (click)=\"createForgotPasswordTab()\"\n                    *ngIf=\"resetPasswordEnabled\"\n                    [@animate]=\"{ value: '*', params: { x: '-50px' } }\"\n                    [color]=\"color\"\n                    class=\"space-top\"\n                    mat-button>\n              {{forgotPasswordButtonText}}\n            </button>\n          </div>\n\n        </mat-card-content>\n        <mat-card-footer *ngIf=\"isLoading\">\n          <mat-progress-bar [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n                            mode=\"indeterminate\"></mat-progress-bar>\n        </mat-card-footer>\n      </mat-card>\n    </mat-tab>\n\n    <!--tab register-->\n    <mat-tab *ngIf=\"registrationEnabled\" [label]=\"registerTabText\">\n      <mat-card>\n        <mat-card-title>{{registerCardTitleText}}</mat-card-title>\n        <mat-card-content fxLayout=\"column\" fxLayoutAlign=\"center\">\n          <form (ngSubmit)=\"signUpFormGroup.valid &&\n            processLegalSignUP(authProvider.EmailAndPassword)\"\n                [@animateStagger]=\"{ value: '50' }\" [formGroup]=\"signUpFormGroup\">\n            <div fxLayout=\"column\" fxLayoutAlign=\"center\">\n              <!--name-->\n              <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                              [appearance]=\"appearance\">\n                <!--labels will work only with @angular/material@6.2.0 -->\n                <mat-label>{{nameText}}</mat-label>\n                <input\n                  [formControl]=\"sigUpNameFormControl\"\n                  [maxlength]=\"config.nameMaxLength\"\n                  [minlength]=\"config.nameMinLength\"\n                  matInput\n                  required\n                />\n                <mat-icon [color]=\"color\" matSuffix>person</mat-icon>\n                <mat-hint align=\"end\" aria-live=\"polite\"> {{ signUpFormGroup.value.name?.length }}\n                  / {{ config.nameMaxLength }} </mat-hint>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('required')\">\n                  {{nameErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('minlength')\">\n                  {{nameErrorMinLengthText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpNameFormControl.hasError('maxlength')\">\n                  {{nameErrorMaxLengthText}}\n                </mat-error>\n              </mat-form-field>\n\n              <!--email-->\n              <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                              [appearance]=\"appearance\">\n                <mat-label>{{emailText}}</mat-label>\n                <input [formControl]=\"sigUpEmailFormControl\"\n                       matInput\n                       required\n                       type=\"email\">\n                <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n                <mat-error *ngIf=\"sigUpEmailFormControl.hasError('required')\">\n                  {{emailErrorRequiredText}}\n                </mat-error>\n                <mat-error *ngIf=\"sigUpEmailFormControl.hasError('pattern')\">\n                  {{emailErrorPatternText}}\n                </mat-error>\n              </mat-form-field>\n\n              <!--password-->\n              <div fxLayout=\"column\">\n                <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                                [appearance]=\"appearance\">\n                  <mat-label>{{passwordText}}</mat-label>\n                  <input\n                    [formControl]=\"sigUpPasswordFormControl\"\n                    [maxlength]=\"max\"\n                    [minlength]=\"min\"\n                    [type]=\"toggle.type\"\n                    matInput\n                    name=\"password\"\n                    required\n                  />\n                  <mat-pass-toggle-visibility #toggle matSuffix></mat-pass-toggle-visibility>\n\n                  <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n\n                  <mat-hint align=\"end\" aria-live=\"polite\">\n                    {{signUpFormGroup.value.password?.length}} / {{ max }}\n                  </mat-hint>\n\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('required')\" class=\"cut-text\">\n                    {{passwordErrorRequiredText}}\n                  </mat-error>\n\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('minlength')\" class=\"cut-text\">\n                    {{ passwordErrorMinLengthText }}\n                  </mat-error>\n                  <mat-error *ngIf=\"sigUpPasswordFormControl.hasError('maxlength')\" class=\"cut-text\">\n                    {{ passwordErrorMaxLengthText }}\n                  </mat-error>\n\n                </mat-form-field>\n\n                <mat-password-strength #passwordStrength\n                                       [customValidator]=\"customValidator\"\n                                       [enableDigitRule]=\"enableDigitRule\"\n                                       [enableLengthRule]=\"enableLengthRule\"\n                                       [enableLowerCaseLetterRule]=\"enableLowerCaseLetterRule\"\n                                       [enableSpecialCharRule]=\"enableSpecialCharRule\"\n                                       [enableUpperCaseLetterRule]=\"enableUpperCaseLetterRule\"\n                                       [externalError]=\"sigUpPasswordFormControl.dirty\"\n                                       [max]=\"max\"\n                                       [min]=\"min\"\n                                       [password]=\"signUpFormGroup.value.password\">\n                </mat-password-strength>\n\n              </div>\n\n              <button [@animate]=\"{ value: '*', params: { x: '100px' } }\"\n                      [color]=\"color\"\n                      [disabled]=\"signUpFormGroup.invalid\"\n                      mat-raised-button\n                      style=\"margin-top: 20px\"\n                      type=\"submit\">\n                {{registerButtonText}}\n              </button>\n\n            </div>\n          </form>\n\n          <button (click)=\"processLegalSignUP(authProvider.ANONYMOUS)\"\n                  *ngIf=\"guestEnabled\"\n                  [@animate]=\"{ value: '*', params: { x: '-100px' } }\"\n                  [color]=\"color\"\n                  mat-button\n                  style=\"margin-top: 20px\">\n            <mat-icon>fingerprint</mat-icon>\n            {{guestButtonText}}\n          </button>\n\n        </mat-card-content>\n\n        <mat-card-footer *ngIf=\"isLoading\">\n          <mat-progress-bar [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n                            mode=\"indeterminate\"></mat-progress-bar>\n        </mat-card-footer>\n\n      </mat-card>\n    </mat-tab>\n\n    <!--Reset password tab-->\n    <mat-tab *ngIf=\"passwordResetWished\" class=\"reset-password-tab\">\n      <ng-template mat-tab-label>\n        <button (click)=\"passwordResetWished = false\" class=\"reset-password-tab__close-button\" mat-icon-button>\n          {{ resetPasswordTabText }}\n          <mat-icon>close</mat-icon>\n        </button>\n      </ng-template>\n      <form (ngSubmit)=\"resetPasswordFormGroup.valid && resetPassword()\"\n            [@animateStagger]=\"{ value: '50' }\"\n            [formGroup]=\"resetPasswordFormGroup\">\n        <mat-card class=\"reset-password-card\">\n          <mat-card-content>\n            <mat-form-field [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\" [appearance]=\"appearance\"\n                            class=\"full-width\">\n              <mat-label> {{ resetPasswordInputText }} </mat-label>\n              <input [title]=\"resetPasswordInputText\"\n                     formControlName=\"email\"\n                     matInput\n                     required>\n              <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n              <mat-error *ngIf=\"resetPasswordEmailFormControl.hasError('required')\">\n                {{resetPasswordErrorRequiredText}}\n              </mat-error>\n              <mat-error *ngIf=\"resetPasswordEmailFormControl.hasError('pattern')\">\n                {{resetPasswordErrorPatternText}}\n              </mat-error>\n            </mat-form-field>\n            <p *ngIf=\"passReset\">{{resetPasswordInstructionsText}}</p>\n          </mat-card-content>\n          <mat-card-actions fxLayoutAlign=\"center\">\n            <mat-progress-bar *ngIf=\"isLoading\" mode=\"indeterminate\"></mat-progress-bar>\n            <button [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n                    [color]=\"color\"\n                    mat-raised-button\n                    type=\"submit\">\n              {{resetPasswordActionButtonText}}\n            </button>\n          </mat-card-actions>\n        </mat-card>\n      </form>\n    </mat-tab>\n\n  </mat-tab-group>\n  <mat-divider></mat-divider>\n  <ngx-auth-firebaseui-providers *ngIf=\"tabIndex !== 2\"\n                                 [providers]=\"providers\"\n                                 [theme]=\"providersTheme\">\n  </ngx-auth-firebaseui-providers>\n</ng-template>\n",
            animations: NgxAuthFirebaseuiAnimations,
            changeDetection: ChangeDetectionStrategy.OnPush,
            styles: [".mat-card{margin:2rem}.space-top{margin-top:.5rem}.full-width{width:100%}.cut-text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.signed-in-container .account-circle{font-size:12rem;width:12rem;height:12rem}.signed-in-container img.account-circle{-o-object-fit:cover;object-fit:cover;border-radius:50%}.signed-in-container .sign-out-button{margin-top:2rem}.signed-in-container .user-display-name{margin-top:1rem}.signed-in-container .user-email{margin-top:-1rem}.signed-in-container .actions{margin-top:2rem}.signed-in-container .actions .action-button,.signed-in-container .actions mat-progress-bar{width:100%}.signed-in-container .actions .action-button{margin-top:1rem}.reset-password-tab mat-progress-bar{margin-bottom:1rem}.reset-password-tab__close-button{width:100%;display:flex;justify-content:space-between;align-items:center}.reset-password-tab__close-button mat-icon{font-size:18px;position:relative;top:-1px}"]
        }),
        __param(0, Inject(PLATFORM_ID)),
        __param(1, Inject(forwardRef(function () { return NgxAuthFirebaseUIConfigToken; })))
    ], AuthComponent);
    return AuthComponent;
}());
export { AuthComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtYXV0aC1maXJlYmFzZXVpLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbmd4LWF1dGgtZmlyZWJhc2V1aS9hdXRoLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDbEQsT0FBTyxFQUNMLGFBQWEsRUFDYix1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxZQUFZLEVBQ1osVUFBVSxFQUNWLE1BQU0sRUFDTixLQUFLLEVBQ0wsU0FBUyxFQUNULFNBQVMsRUFDVCxNQUFNLEVBQ04sTUFBTSxFQUNOLFdBQVcsRUFDWCxhQUFhLEVBQ2IsV0FBVyxFQUNYLFNBQVMsRUFDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFrQixXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBRW5GLG1CQUFtQjtBQUNuQixPQUFPLEVBQW9CLFdBQVcsRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBRXRFLE9BQU8sRUFBQyxTQUFTLEVBQUUsWUFBWSxFQUFDLE1BQU0sMEJBQTBCLENBQUM7QUFHakUsZUFBZTtBQUNmLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUVuRCxjQUFjO0FBQ2QsT0FBTyxFQUFDLDRCQUE0QixFQUFDLE1BQU0sZ0RBQWdELENBQUM7QUFLNUYsT0FBTyxFQUFDLHVCQUF1QixFQUFRLE1BQU0sSUFBSSxDQUFDO0FBRWxELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxZQUFZLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUN0RixPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsNEJBQTRCLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFHMUQsTUFBTSxDQUFDLElBQU0sV0FBVyxHQUFHLElBQUksTUFBTSxDQUFDLENBQUMsZ0VBQWdFO0lBQ3JHLHVEQUF1RDtJQUN2RCxzQ0FBc0M7SUFDdEMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUUvQiwyQ0FBMkM7QUFDM0MsTUFBTSxDQUFDLElBQU0sa0JBQWtCLEdBQUcsSUFBSSxNQUFNLENBQUMsQ0FBQyxpR0FBaUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBUzNKO0lBc0hFO0lBQ0UscUNBQXFDO0lBQ1IsVUFBa0IsRUFDZ0IsTUFBK0IsRUFDdkYsSUFBcUIsRUFDckIsV0FBK0IsRUFDL0IsTUFBaUIsRUFDaEIsY0FBOEIsRUFDOUIsaUJBQW9DO1FBTmYsZUFBVSxHQUFWLFVBQVUsQ0FBUTtRQUNnQixXQUFNLEdBQU4sTUFBTSxDQUF5QjtRQUN2RixTQUFJLEdBQUosSUFBSSxDQUFpQjtRQUNyQixnQkFBVyxHQUFYLFdBQVcsQ0FBb0I7UUFDL0IsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUNoQixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtRQXhIOUMsMEVBQTBFO1FBQ2pFLGNBQVMsR0FBa0MsWUFBWSxDQUFDLEdBQUcsQ0FBQztRQUs1RCx3QkFBbUIsR0FBRyxJQUFJLENBQUM7UUFDM0IseUJBQW9CLEdBQUcsSUFBSSxDQUFDO1FBQzVCLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBYW5CLHNCQUFpQixHQUFvQyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRWxGLHdCQUF3QjtRQUNmLHFCQUFnQixHQUFHLElBQUksQ0FBQztRQUN4Qiw4QkFBeUIsR0FBRyxJQUFJLENBQUM7UUFDakMsOEJBQXlCLEdBQUcsSUFBSSxDQUFDO1FBQ2pDLG9CQUFlLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLDBCQUFxQixHQUFHLElBQUksQ0FBQztRQUl0QywrQ0FBK0M7UUFDckMsc0JBQWlCLEdBQXlCLElBQUksWUFBWSxFQUFFLENBQUM7UUFVOUQsMEJBQXFCLEdBQUcsU0FBUyxDQUFDO1FBRWxDLGdCQUFXLEdBQUcsVUFBVSxDQUFDO1FBRWxDLHFCQUFxQjtRQUNyQixxQkFBcUI7UUFDWix5QkFBb0IsR0FBRyxrQ0FBa0MsQ0FBQztRQUMxRCwyQkFBc0IsR0FBRyxrQ0FBa0MsQ0FBQztRQUM1RCxtQ0FBOEIsR0FBRywyQ0FBMkMsQ0FBQztRQUM3RSxrQ0FBNkIsR0FBRyxxQ0FBcUMsQ0FBQztRQUN0RSxrQ0FBNkIsR0FBRyxPQUFPLENBQUM7UUFDeEMsa0NBQTZCLEdBQUcsa0RBQWtELENBQUM7UUFFNUYsYUFBYTtRQUNKLGtCQUFhLEdBQUcsU0FBUyxDQUFDO1FBQzFCLHdCQUFtQixHQUFHLFlBQVksQ0FBQztRQUNuQyxvQkFBZSxHQUFHLFFBQVEsQ0FBQztRQUMzQiw2QkFBd0IsR0FBRyxtQkFBbUIsQ0FBQztRQUV4RCxTQUFTO1FBQ0EsYUFBUSxHQUFHLE1BQU0sQ0FBQztRQUNsQiwwQkFBcUIsR0FBRyxrQkFBa0IsQ0FBQztRQUMzQywyQkFBc0IsR0FBRyx3QkFBd0IsQ0FBQztRQUNsRCwyQkFBc0IsR0FBRyx1QkFBdUIsQ0FBQztRQUVqRCxjQUFTLEdBQUcsUUFBUSxDQUFDO1FBQ3JCLDJCQUFzQixHQUFHLG9CQUFvQixDQUFDO1FBQzlDLDBCQUFxQixHQUFHLHFDQUFxQyxDQUFDO1FBRTlELGlCQUFZLEdBQUcsVUFBVSxDQUFDO1FBQzFCLDhCQUF5QixHQUFHLHNCQUFzQixDQUFDO1FBQ25ELCtCQUEwQixHQUFHLDRCQUE0QixDQUFDO1FBQzFELCtCQUEwQixHQUFHLDJCQUEyQixDQUFDO1FBRWxFLGVBQWU7UUFDTixvQkFBZSxHQUFHLFVBQVUsQ0FBQztRQUM3QiwwQkFBcUIsR0FBRyxjQUFjLENBQUM7UUFDdkMsdUJBQWtCLEdBQUcsVUFBVSxDQUFDO1FBQ2hDLG9CQUFlLEdBQUcsbUJBQW1CLENBQUM7UUFFL0MsK0JBQStCO1FBQ3RCLDJCQUFzQixHQUFHLDhCQUE4QixDQUFDO1FBQ2pFLDJDQUEyQztRQUNsQywwQkFBcUIsR0FBRywwSUFBd0ksQ0FBQztRQUUxSyxpQkFBWSxHQUFHLFlBQVksQ0FBQztRQVE1Qix3QkFBbUIsR0FBRyxLQUFLLENBQUM7UUFFNUIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUdsQixrQkFBYSxHQUFHLFlBQVksQ0FBQztRQXFCM0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxXQUFXLENBQUMsZ0JBQWdCLENBQUM7UUFDOUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxXQUFXLENBQUMsY0FBYyxDQUFDO0lBQzVDLENBQUM7SUFFRCxzQkFBSSxnQ0FBSzthQUFUO1lBQ0UsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQ3ZELENBQUM7OztPQUFBO0lBRU0sZ0NBQVEsR0FBZjtRQUFBLGlCQWNDO1FBYkMsSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDdEMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLGNBQU0sT0FBQSxLQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxFQUEvQixDQUErQixDQUFDLENBQUM7U0FDMUY7UUFDRCxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDO1FBQ2hILElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUM7UUFFaEgsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFdEMsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7UUFDbEMsNkJBQTZCO1FBQzdCLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyxrQ0FBa0MsRUFBRSxDQUFDO0lBQzVDLENBQUM7SUFFRCx1Q0FBZSxHQUFmO1FBQUEsaUJBTUM7UUFMQyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtZQUN6QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLFVBQUMsUUFBZ0I7Z0JBQ2pFLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDeEMsQ0FBQyxDQUFDLENBQUM7U0FDSjtJQUNILENBQUM7SUFFRCxtQ0FBVyxHQUFYLFVBQVksT0FBc0I7UUFDaEMsSUFBSSxPQUFPLENBQUMsb0JBQW9CLElBQUksT0FBTyxDQUFDLGtCQUFrQixFQUFFO1lBQzlELElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO1NBQ25DO1FBQ0QsSUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO1lBQ2YsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQztTQUNqSDtRQUNELElBQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtZQUNmLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUM7U0FDakg7UUFDRCxJQUFJLE9BQU8sQ0FBQyxTQUFTLEVBQUU7WUFDckIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7U0FDdkM7SUFDSCxDQUFDO0lBRUQsbUNBQVcsR0FBWDtRQUNFLElBQUksSUFBSSxDQUFDLG1CQUFtQixFQUFFO1lBQzVCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUN4QztJQUNILENBQUM7SUFFRCxtQ0FBVyxHQUFYLFVBQVksS0FBd0I7UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUM7SUFDOUIsQ0FBQztJQUVLLCtCQUFPLEdBQWI7Ozs7Ozt3QkFFSSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQzt3QkFDdEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUN0QyxxQkFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxFQUFBOzt3QkFBaEMsU0FBZ0MsQ0FBQzs7O3dCQUVqQyxJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQzt3QkFDdkIsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUM7d0JBQ2xCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQzs7Ozs7O0tBRXpDO0lBRUssOEJBQU0sR0FBWjs7Ozs7d0JBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFOzRCQUMvQixzQkFBTzt5QkFDUjs7Ozt3QkFFQyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQzt3QkFDdEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUN0QyxxQkFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGdCQUFnQixFQUFFO2dDQUNyRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsS0FBSztnQ0FDdkMsUUFBUSxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLFFBQVE7NkJBQzlDLENBQUMsRUFBQTs7d0JBSEYsU0FHRSxDQUFDOzs7d0JBRUgsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7d0JBQ3ZCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQzs7Ozs7O0tBRXpDO0lBRUQsa0RBQTBCLEdBQTFCO1FBQ0UsSUFBSSxDQUFDLFdBQVcsQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUM7UUFDbEUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDaEUsQ0FBQztJQUVELCtDQUF1QixHQUF2QjtRQUNFLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUM7UUFDaEMsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUM7UUFDbEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3hDLENBQUM7SUFFRCwwQ0FBa0IsR0FBbEIsVUFBbUIsWUFBMkI7UUFBOUMsaUJBa0JDO1FBakJDLElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDeEMsSUFBTSxNQUFNLEdBQXlCO2dCQUNuQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU07Z0JBQ25CLGdCQUFnQixFQUFFLElBQUksQ0FBQyxnQkFBZ0I7Z0JBQ3ZDLFlBQVksY0FBQTthQUNiLENBQUM7WUFFRixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUM7WUFDM0UsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxTQUFTLENBQUMsVUFBQyxNQUE0QjtnQkFDbEUsSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLE9BQU8sRUFBRTtvQkFDNUIsS0FBSSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBTSxPQUFBLEtBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQTVCLENBQTRCLENBQUMsQ0FBQztpQkFDM0Y7Z0JBQ0QsS0FBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7WUFDeEIsQ0FBQyxDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFNLE9BQUEsS0FBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsRUFBNUIsQ0FBNEIsQ0FBQyxDQUFDO1NBQ3BGO0lBQ0gsQ0FBQztJQUVLLDhCQUFNLEdBQVo7Ozs7Ozt3QkFFSSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQzt3QkFDdEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO3dCQUMvQixxQkFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FDbEMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUMvQjtnQ0FDRSxLQUFLLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsS0FBSztnQ0FDdkMsUUFBUSxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLFFBQVE7NkJBQzlDLENBQ0YsRUFBQTs0QkFORCxzQkFBTyxTQU1OLEVBQUM7O3dCQUVGLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO3dCQUN2QixJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFLENBQUM7Ozs7OztLQUV6QztJQUVLLHlDQUFpQixHQUF2Qjs7Ozs7O3dCQUVJLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO3dCQUN0QixJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFLENBQUM7d0JBQ3RDLHFCQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLEVBQUE7O3dCQUE5RCxTQUE4RCxDQUFDOzs7d0JBRS9ELElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO3dCQUN2QixJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFLENBQUM7Ozs7OztLQUV6QztJQUdELHFDQUFhLEdBQWI7UUFBQSxpQkFPQztRQU5DLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLENBQUM7YUFDckUsSUFBSSxDQUFDO1lBQ0osS0FBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7WUFDdEIscUJBQXFCO1lBQ3JCLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTyxxQ0FBYSxHQUFyQjtRQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLFdBQVcsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLEdBQUcsQ0FBQztJQUN2RixDQUFDO0lBRU8sbURBQTJCLEdBQW5DO1FBQ0UsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLHNCQUFzQixHQUFHLElBQUksV0FBVyxDQUFDLEVBQUUsRUFDNUY7WUFDRSxVQUFVLENBQUMsUUFBUTtZQUNuQixVQUFVLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztTQUNoQyxDQUFDLENBQUMsQ0FBQztRQUNOLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUNqRztZQUNFLFVBQVUsQ0FBQyxRQUFRO1lBQ25CLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztZQUM5QixVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7U0FDL0IsQ0FBQyxDQUFDLENBQUM7SUFDUixDQUFDO0lBRU8sbURBQTJCLEdBQW5DO1FBQ0UsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLFNBQVMsQ0FBQztZQUNuQyxJQUFJLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksV0FBVyxDQUFDLEVBQUUsRUFDbEQ7Z0JBQ0UsVUFBVSxDQUFDLFFBQVE7Z0JBQ25CLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUM7Z0JBQy9DLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUM7YUFDaEQsQ0FBQztZQUNKLEtBQUssRUFBRSxJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUNwRDtnQkFDRSxVQUFVLENBQUMsUUFBUTtnQkFDbkIsVUFBVSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7YUFDaEMsQ0FBQztZQUNKLFFBQVEsRUFBRSxJQUFJLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxXQUFXLENBQUMsRUFBRSxFQUMxRDtnQkFDRSxVQUFVLENBQUMsUUFBUTtnQkFDbkIsVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO2dCQUM5QixVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7YUFDL0IsQ0FBQztTQUNMLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTywwREFBa0MsR0FBMUM7UUFDRSxJQUFJLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxTQUFTLENBQUM7WUFDMUMsS0FBSyxFQUFFLElBQUksQ0FBQyw2QkFBNkIsR0FBRyxJQUFJLFdBQVcsQ0FBQyxFQUFFLEVBQzVEO2dCQUNFLFVBQVUsQ0FBQyxRQUFRO2dCQUNuQixVQUFVLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQzthQUNoQyxDQUFDO1NBQ0wsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVPLDhDQUFzQixHQUE5QixVQUErQixZQUEyQjtRQUN4RCxJQUFJLFlBQVksS0FBSyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRTtZQUNoRCxPQUFPLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1NBQ2pDO1FBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7Z0JBNU4wQyxNQUFNLHVCQUE5QyxNQUFNLFNBQUMsV0FBVztnREFDbEIsTUFBTSxTQUFDLFVBQVUsQ0FBQyxjQUFNLE9BQUEsNEJBQTRCLEVBQTVCLENBQTRCLENBQUM7Z0JBQ3pDLGVBQWU7Z0JBQ1Isa0JBQWtCO2dCQUN2QixTQUFTO2dCQUNBLGNBQWM7Z0JBQ1gsaUJBQWlCOztJQTVITDtRQUF4QyxTQUFTLENBQUMsV0FBVyxFQUFFLEVBQUMsTUFBTSxFQUFFLEtBQUssRUFBQyxDQUFDO3NEQUEwQjtJQUNSO1FBQXpELFNBQVMsQ0FBQyw0QkFBNEIsRUFBRSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQzsyREFBZ0Q7SUFJaEc7UUFBUixLQUFLLEVBQUU7b0RBQTZEO0lBQzVEO1FBQVIsS0FBSyxFQUFFO3lEQUF1QjtJQUV0QjtRQUFSLEtBQUssRUFBRTtxREFBb0M7SUFDbkM7UUFBUixLQUFLLEVBQUU7bURBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFOzhEQUE0QjtJQUMzQjtRQUFSLEtBQUssRUFBRTsrREFBNkI7SUFDNUI7UUFBUixLQUFLLEVBQUU7dURBQXFCO0lBQ3BCO1FBQVIsS0FBSyxFQUFFO2lEQUFnQjtJQUNmO1FBQVIsS0FBSyxFQUFFOzJEQUEwQjtJQUN6QjtRQUFSLEtBQUssRUFBRTtvREFBbUI7SUFDbEI7UUFBUixLQUFLLEVBQUU7K0RBQThCO0lBQzdCO1FBQVIsS0FBSyxFQUFFOzZEQUE0QjtJQUMzQjtRQUFSLEtBQUssRUFBRTs0RUFBMkM7SUFJekM7UUFBVCxNQUFNLEVBQUU7b0RBQWdCO0lBRWY7UUFBVCxNQUFNLEVBQUU7a0RBQWM7SUFDYjtRQUFULE1BQU0sRUFBRTs0REFBeUU7SUFHekU7UUFBUixLQUFLLEVBQUU7MkRBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFO29FQUFrQztJQUNqQztRQUFSLEtBQUssRUFBRTtvRUFBa0M7SUFDakM7UUFBUixLQUFLLEVBQUU7MERBQXdCO0lBQ3ZCO1FBQVIsS0FBSyxFQUFFO2dFQUE4QjtJQUM3QjtRQUFSLEtBQUssRUFBRTs4Q0FBYTtJQUNaO1FBQVIsS0FBSyxFQUFFOzhDQUFhO0lBQ1o7UUFBUixLQUFLLEVBQUU7MERBQXlCO0lBRXZCO1FBQVQsTUFBTSxFQUFFOzREQUE4RDtJQUk5RDtRQUFSLEtBQUssRUFBRTs4REFBdUM7SUFJdEM7UUFBUixLQUFLLEVBQUU7K0RBQThCO0lBQzdCO1FBQVIsS0FBSyxFQUFFO3NFQUFxQztJQUNwQztRQUFSLEtBQUssRUFBRTtnRUFBbUM7SUFDbEM7UUFBUixLQUFLLEVBQUU7dUVBQXNDO0lBQ3JDO1FBQVIsS0FBSyxFQUFFO3NEQUEwQjtJQUl6QjtRQUFSLEtBQUssRUFBRTsrREFBMkQ7SUFDMUQ7UUFBUixLQUFLLEVBQUU7aUVBQTZEO0lBQzVEO1FBQVIsS0FBSyxFQUFFO3lFQUE4RTtJQUM3RTtRQUFSLEtBQUssRUFBRTt3RUFBdUU7SUFDdEU7UUFBUixLQUFLLEVBQUU7d0VBQXlDO0lBQ3hDO1FBQVIsS0FBSyxFQUFFO3dFQUFvRjtJQUduRjtRQUFSLEtBQUssRUFBRTt3REFBMkI7SUFDMUI7UUFBUixLQUFLLEVBQUU7OERBQW9DO0lBQ25DO1FBQVIsS0FBSyxFQUFFOzBEQUE0QjtJQUMzQjtRQUFSLEtBQUssRUFBRTttRUFBZ0Q7SUFHL0M7UUFBUixLQUFLLEVBQUU7bURBQW1CO0lBQ2xCO1FBQVIsS0FBSyxFQUFFO2dFQUE0QztJQUMzQztRQUFSLEtBQUssRUFBRTtpRUFBbUQ7SUFDbEQ7UUFBUixLQUFLLEVBQUU7aUVBQWtEO0lBRWpEO1FBQVIsS0FBSyxFQUFFO29EQUFzQjtJQUNyQjtRQUFSLEtBQUssRUFBRTtpRUFBK0M7SUFDOUM7UUFBUixLQUFLLEVBQUU7Z0VBQStEO0lBRTlEO1FBQVIsS0FBSyxFQUFFO3VEQUEyQjtJQUMxQjtRQUFSLEtBQUssRUFBRTtvRUFBb0Q7SUFDbkQ7UUFBUixLQUFLLEVBQUU7cUVBQTJEO0lBQzFEO1FBQVIsS0FBSyxFQUFFO3FFQUEwRDtJQUd6RDtRQUFSLEtBQUssRUFBRTswREFBOEI7SUFDN0I7UUFBUixLQUFLLEVBQUU7Z0VBQXdDO0lBQ3ZDO1FBQVIsS0FBSyxFQUFFOzZEQUFpQztJQUNoQztRQUFSLEtBQUssRUFBRTswREFBdUM7SUFHdEM7UUFBUixLQUFLLEVBQUU7aUVBQXlEO0lBRXhEO1FBQVIsS0FBSyxFQUFFO2dFQUFrSztJQTVGL0osYUFBYTtRQVB6QixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUscUJBQXFCO1lBQy9CLDhzY0FBa0M7WUFFbEMsVUFBVSxFQUFFLDJCQUEyQjtZQUN2QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTs7U0FDaEQsQ0FBQztRQXlIRyxXQUFBLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQTtRQUNuQixXQUFBLE1BQU0sQ0FBQyxVQUFVLENBQUMsY0FBTSxPQUFBLDRCQUE0QixFQUE1QixDQUE0QixDQUFDLENBQUMsQ0FBQTtPQXpIOUMsYUFBYSxDQXNWekI7SUFBRCxvQkFBQztDQUFBLEFBdFZELElBc1ZDO1NBdFZZLGFBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzUGxhdGZvcm1Ccm93c2VyfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgZm9yd2FyZFJlZixcbiAgSW5qZWN0LFxuICBJbnB1dCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBQTEFURk9STV9JRCxcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgVGVtcGxhdGVSZWYsXG4gIFZpZXdDaGlsZFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QWN0aXZhdGVkUm91dGV9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQge0Fic3RyYWN0Q29udHJvbCwgRm9ybUNvbnRyb2wsIEZvcm1Hcm91cCwgVmFsaWRhdG9yc30gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuXG4vLyBBTkdVTEFSIE1BVEVSSUFMXG5pbXBvcnQge01hdFRhYkNoYW5nZUV2ZW50LCBNYXRUYWJHcm91cH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvdGFicyc7XG5pbXBvcnQge1RoZW1lUGFsZXR0ZX0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvY29yZSc7XG5pbXBvcnQge01hdERpYWxvZywgTWF0RGlhbG9nUmVmfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaWFsb2cnO1xuaW1wb3J0IHtNYXRGb3JtRmllbGRBcHBlYXJhbmNlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9mb3JtLWZpZWxkJztcblxuLy8gQU5HVUxBUiBGSVJFXG5pbXBvcnQge0FuZ3VsYXJGaXJlQXV0aH0gZnJvbSAnQGFuZ3VsYXIvZmlyZS9hdXRoJztcblxuLy8gVGhpcmQgUEFSVFlcbmltcG9ydCB7TWF0UGFzc3dvcmRTdHJlbmd0aENvbXBvbmVudH0gZnJvbSAnQGFuZ3VsYXItbWF0ZXJpYWwtZXh0ZW5zaW9ucy9wYXNzd29yZC1zdHJlbmd0aCc7XG5cbi8vIFJYSlNcbmltcG9ydCB7U3Vic2NyaXB0aW9ufSBmcm9tICdyeGpzL2ludGVybmFsL1N1YnNjcmlwdGlvbic7XG5cbmltcG9ydCB7TGVnYWxpdHlEaWFsb2dDb21wb25lbnQsIFRoZW1lfSBmcm9tICcuLic7XG5pbXBvcnQge0xlZ2FsaXR5RGlhbG9nUGFyYW1zLCBMZWdhbGl0eURpYWxvZ1Jlc3VsdCwgTmd4QXV0aEZpcmViYXNlVUlDb25maWd9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgQXV0aFByb2Nlc3NTZXJ2aWNlLCBBdXRoUHJvdmlkZXJ9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2F1dGgtcHJvY2Vzcy5zZXJ2aWNlJztcbmltcG9ydCB7Tmd4QXV0aEZpcmViYXNldWlBbmltYXRpb25zfSBmcm9tICcuLi8uLi9hbmltYXRpb25zJztcbmltcG9ydCB7Tmd4QXV0aEZpcmViYXNlVUlDb25maWdUb2tlbn0gZnJvbSAnLi4vLi4vdG9rZW5zJztcblxuXG5leHBvcnQgY29uc3QgRU1BSUxfUkVHRVggPSBuZXcgUmVnRXhwKFsnXigoW148PigpW1xcXFxdXFxcXFxcLiw7OlxcXFxzQFxcXCJdKyhcXFxcLltePD4oKVxcXFxbXFxcXF1cXFxcXFwuLDs6XFxcXHNAXFxcIl0rKSopJyxcbiAgJ3woXCIuK1wiKSlAKChcXFxcW1swLTldezEsM31cXFxcLlswLTldezEsM31cXFxcLlswLTldezEsM31cXFxcLicsXG4gICdbMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXFxcLTAtOV0rXFxcXC4pKycsXG4gICdbYS16QS1aXXsyLH0pKSQnXS5qb2luKCcnKSk7XG5cbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbmV4cG9ydCBjb25zdCBQSE9ORV9OVU1CRVJfUkVHRVggPSBuZXcgUmVnRXhwKFsnXlsrXXswLDF9WyhdezAsMX1bMC05XXsxLDR9WyldezAsMX1bLVxcXFxzXFxcXC5dezAsMX1bKF17MCwxfVswLTldezEsNH1bKV17MCwxfVstXFxcXHNcXFxcLi8wLTldezQsMTJ9JCddLmpvaW4oJycpKTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWF1dGgtZmlyZWJhc2V1aScsXG4gIHRlbXBsYXRlVXJsOiAnYXV0aC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWydhdXRoLmNvbXBvbmVudC5zY3NzJ10sXG4gIGFuaW1hdGlvbnM6IE5neEF1dGhGaXJlYmFzZXVpQW5pbWF0aW9ucyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgQXV0aENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuXG4gIEBWaWV3Q2hpbGQoTWF0VGFiR3JvdXAsIHtzdGF0aWM6IGZhbHNlfSkgbWF0VGFiR3JvdXA6IE1hdFRhYkdyb3VwO1xuICBAVmlld0NoaWxkKE1hdFBhc3N3b3JkU3RyZW5ndGhDb21wb25lbnQsIHtzdGF0aWM6IGZhbHNlfSkgcGFzc3dvcmRTdHJlbmd0aDogTWF0UGFzc3dvcmRTdHJlbmd0aENvbXBvbmVudDtcblxuICBpc0xvYWRpbmc6IGJvb2xlYW47XG4gIC8vICBnb29nbGUsIGZhY2Vib29rLCB0d2l0dGVyLCBnaXRodWIgYXMgYXJyYXkgb3IgYWxsIGFzIG9uZSBzaW5nbGUgc3RyaW5nXG4gIEBJbnB1dCgpIHByb3ZpZGVyczogQXV0aFByb3ZpZGVyW10gfCBBdXRoUHJvdmlkZXIgPSBBdXRoUHJvdmlkZXIuQUxMO1xuICBASW5wdXQoKSBwcm92aWRlcnNUaGVtZTogVGhlbWU7IC8vIENsYXNzaWMsIFN0cm9rZWQsIGV0Yy5cblxuICBASW5wdXQoKSBhcHBlYXJhbmNlOiBNYXRGb3JtRmllbGRBcHBlYXJhbmNlO1xuICBASW5wdXQoKSB0YWJJbmRleDogbnVtYmVyIHwgbnVsbDtcbiAgQElucHV0KCkgcmVnaXN0cmF0aW9uRW5hYmxlZCA9IHRydWU7XG4gIEBJbnB1dCgpIHJlc2V0UGFzc3dvcmRFbmFibGVkID0gdHJ1ZTtcbiAgQElucHV0KCkgZ3Vlc3RFbmFibGVkID0gdHJ1ZTtcbiAgQElucHV0KCkgdG9zVXJsOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHByaXZhY3lQb2xpY3lVcmw6IHN0cmluZztcbiAgQElucHV0KCkgZ29CYWNrVVJMOiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1lc3NhZ2VPbkF1dGhTdWNjZXNzOiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1lc3NhZ2VPbkF1dGhFcnJvcjogc3RyaW5nO1xuICBASW5wdXQoKSBtZXNzYWdlT25FbWFpbENvbmZpcm1hdGlvblN1Y2Nlc3M6IHN0cmluZztcblxuICAvLyBFdmVudHNcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW91dHB1dC1vbi1wcmVmaXhcbiAgQE91dHB1dCgpIG9uU3VjY2VzczogYW55O1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KCkgb25FcnJvcjogYW55O1xuICBAT3V0cHV0KCkgc2VsZWN0ZWRUYWJDaGFuZ2U6IEV2ZW50RW1pdHRlcjxNYXRUYWJDaGFuZ2VFdmVudD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgLy8gUGFzc3dvcmQgc3RyZW5ndGggYXBpXG4gIEBJbnB1dCgpIGVuYWJsZUxlbmd0aFJ1bGUgPSB0cnVlO1xuICBASW5wdXQoKSBlbmFibGVMb3dlckNhc2VMZXR0ZXJSdWxlID0gdHJ1ZTtcbiAgQElucHV0KCkgZW5hYmxlVXBwZXJDYXNlTGV0dGVyUnVsZSA9IHRydWU7XG4gIEBJbnB1dCgpIGVuYWJsZURpZ2l0UnVsZSA9IHRydWU7XG4gIEBJbnB1dCgpIGVuYWJsZVNwZWNpYWxDaGFyUnVsZSA9IHRydWU7XG4gIEBJbnB1dCgpIG1pbjogbnVtYmVyO1xuICBASW5wdXQoKSBtYXg6IG51bWJlcjtcbiAgQElucHV0KCkgY3VzdG9tVmFsaWRhdG9yOiBSZWdFeHA7XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1vdXRwdXQtb24tcHJlZml4XG4gIEBPdXRwdXQoKSBvblN0cmVuZ3RoQ2hhbmdlZDogRXZlbnRFbWl0dGVyPG51bWJlcj4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgLy8gVmVyaWZ5IGVtYWlsIHRlbXBsYXRlIHRvIHVzZSBpbiBwbGFjZSBvZiBkZWZhdWx0IHRlbXBsYXRlLlxuICAvLyBTZWUgZW1haWwtY29uZmlybWF0aW9uIGNvbXBvbmVudFxuICBASW5wdXQoKSB2ZXJpZnlFbWFpbFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIC8vIGkxOG4gdHJhbnNsYXRpb25zIHRvIHVzZSBpbiBkZWZhdWx0IHRlbXBsYXRlIGZvciBlbWFpbCB2ZXJpZmljYXRpb24uXG4gIC8vIFNlZSBlbWFpbC1jb25maXJtYXRpb24gY29tcG9uZW50XG4gIEBJbnB1dCgpIHZlcmlmeUVtYWlsVGl0bGVUZXh0OiBzdHJpbmc7XG4gIEBJbnB1dCgpIHZlcmlmeUVtYWlsQ29uZmlybWF0aW9uVGV4dDogc3RyaW5nO1xuICBASW5wdXQoKSB2ZXJpZnlFbWFpbEdvQmFja1RleHQgPSAnR28gYmFjayc7XG4gIEBJbnB1dCgpIHNlbmROZXdWZXJpZmljYXRpb25FbWFpbFRleHQ6IHN0cmluZztcbiAgQElucHV0KCkgc2lnbk91dFRleHQgPSAnU2lnbiBvdXQnO1xuXG4gIC8vIEN1c3RvbWl6ZSB0aGUgdGV4dFxuICAvLyBSZXNldCBQYXNzd29yZCBUYWJcbiAgQElucHV0KCkgcmVzZXRQYXNzd29yZFRhYlRleHQgPSAnUmVzZXQgZS1tYWlsIGFkZHJlc3MgdG8gcGFzc3dvcmQnO1xuICBASW5wdXQoKSByZXNldFBhc3N3b3JkSW5wdXRUZXh0ID0gJ1Jlc2V0IGUtbWFpbCBhZGRyZXNzIHRvIHBhc3N3b3JkJztcbiAgQElucHV0KCkgcmVzZXRQYXNzd29yZEVycm9yUmVxdWlyZWRUZXh0ID0gJ0UtbWFpbCBpcyByZXF1aXJlZCB0byByZXNldCB0aGUgcGFzc3dvcmQhJztcbiAgQElucHV0KCkgcmVzZXRQYXNzd29yZEVycm9yUGF0dGVyblRleHQgPSAnUGxlYXNlIGVudGVyIGEgdmFsaWQgZS1tYWlsIGFkZHJlc3MnO1xuICBASW5wdXQoKSByZXNldFBhc3N3b3JkQWN0aW9uQnV0dG9uVGV4dCA9ICdSZXNldCc7XG4gIEBJbnB1dCgpIHJlc2V0UGFzc3dvcmRJbnN0cnVjdGlvbnNUZXh0ID0gJ1Jlc2V0IHJlcXVlc3RlZC4gQ2hlY2sgeW91ciBlLW1haWwgaW5zdHJ1Y3Rpb25zLic7XG5cbiAgLy8gU2lnbkluIFRhYlxuICBASW5wdXQoKSBzaWduSW5UYWJUZXh0ID0gJ1NpZ24gaW4nO1xuICBASW5wdXQoKSBzaWduSW5DYXJkVGl0bGVUZXh0ID0gJ1NpZ25pbmcgaW4nO1xuICBASW5wdXQoKSBsb2dpbkJ1dHRvblRleHQgPSAnTG9nIEluJztcbiAgQElucHV0KCkgZm9yZ290UGFzc3dvcmRCdXR0b25UZXh0ID0gJ0ZvcmdvdCBQYXNzd29yZCA/JztcblxuICAvLyBDb21tb25cbiAgQElucHV0KCkgbmFtZVRleHQgPSAnTmFtZSc7XG4gIEBJbnB1dCgpIG5hbWVFcnJvclJlcXVpcmVkVGV4dCA9ICdOYW1lIGlzIHJlcXVpcmVkJztcbiAgQElucHV0KCkgbmFtZUVycm9yTWluTGVuZ3RoVGV4dCA9ICdUaGUgbmFtZSBpcyB0b28gc2hvcnQhJztcbiAgQElucHV0KCkgbmFtZUVycm9yTWF4TGVuZ3RoVGV4dCA9ICdUaGUgbmFtZSBpcyB0b28gbG9uZyEnO1xuXG4gIEBJbnB1dCgpIGVtYWlsVGV4dCA9ICdFLW1haWwnO1xuICBASW5wdXQoKSBlbWFpbEVycm9yUmVxdWlyZWRUZXh0ID0gJ0UtbWFpbCBpcyByZXF1aXJlZCc7XG4gIEBJbnB1dCgpIGVtYWlsRXJyb3JQYXR0ZXJuVGV4dCA9ICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBlLW1haWwgYWRkcmVzcyc7XG5cbiAgQElucHV0KCkgcGFzc3dvcmRUZXh0ID0gJ1Bhc3N3b3JkJztcbiAgQElucHV0KCkgcGFzc3dvcmRFcnJvclJlcXVpcmVkVGV4dCA9ICdQYXNzd29yZCBpcyByZXF1aXJlZCc7XG4gIEBJbnB1dCgpIHBhc3N3b3JkRXJyb3JNaW5MZW5ndGhUZXh0ID0gJ1RoZSBwYXNzd29yZCBpcyB0b28gc2hvcnQhJztcbiAgQElucHV0KCkgcGFzc3dvcmRFcnJvck1heExlbmd0aFRleHQgPSAnVGhlIHBhc3N3b3JkIGlzIHRvbyBsb25nISc7XG5cbiAgLy8gUmVnaXN0ZXIgVGFiXG4gIEBJbnB1dCgpIHJlZ2lzdGVyVGFiVGV4dCA9ICdSZWdpc3Rlcic7XG4gIEBJbnB1dCgpIHJlZ2lzdGVyQ2FyZFRpdGxlVGV4dCA9ICdSZWdpc3RyYXRpb24nO1xuICBASW5wdXQoKSByZWdpc3RlckJ1dHRvblRleHQgPSAnUmVnaXN0ZXInO1xuICBASW5wdXQoKSBndWVzdEJ1dHRvblRleHQgPSAnY29udGludWUgYXMgZ3Vlc3QnO1xuXG4gIC8vIGVtYWlsIGNvbmZpcm1hdGlvbiBjb21wb25lbnRcbiAgQElucHV0KCkgZW1haWxDb25maXJtYXRpb25UaXRsZSA9ICdDb25maXJtIHlvdXIgZS1tYWlsIGFkZHJlc3MhJztcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICBASW5wdXQoKSBlbWFpbENvbmZpcm1hdGlvblRleHQgPSBgQSBjb25maXJtYXRpb24gZS1tYWlsIGhhcyBiZWVuIHNlbnQgdG8geW91LiBDaGVjayB5b3VyIGluYm94IGFuZCBjbGljayBvbiB0aGUgbGluayBcIkNvbmZpcm0gbXkgZS1tYWlsXCIgdG8gY29uZmlybSB5b3VyIGUtbWFpbCBhZGRyZXNzLmA7XG5cbiAgYXV0aFByb3ZpZGVyID0gQXV0aFByb3ZpZGVyO1xuICBwYXNzd29yZFJlc2V0V2lzaGVkOiBib29sZWFuO1xuXG4gIHB1YmxpYyBzaWduSW5Gb3JtR3JvdXA6IEZvcm1Hcm91cDtcbiAgcHVibGljIHNpZ25VcEZvcm1Hcm91cDogRm9ybUdyb3VwO1xuICBwdWJsaWMgcmVzZXRQYXNzd29yZEZvcm1Hcm91cDogRm9ybUdyb3VwO1xuXG4gIG9uRXJyb3JTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgYXV0aGVudGljYXRpb25FcnJvciA9IGZhbHNlO1xuXG4gIHBhc3NSZXNldCA9IGZhbHNlO1xuICBkaWFsb2dSZWY6IE1hdERpYWxvZ1JlZjxMZWdhbGl0eURpYWxvZ0NvbXBvbmVudD47XG5cbiAgYXV0aFByb3ZpZGVycyA9IEF1dGhQcm92aWRlcjtcblxuICBzaWduSW5FbWFpbEZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG4gIHNpZ0luUGFzc3dvcmRGb3JtQ29udHJvbDogQWJzdHJhY3RDb250cm9sO1xuXG4gIHNpZ1VwTmFtZUZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG4gIHNpZ1VwRW1haWxGb3JtQ29udHJvbDogQWJzdHJhY3RDb250cm9sO1xuICBzaWdVcFBhc3N3b3JkRm9ybUNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDtcbiAgc2lnVXBQYXNzd29yZENvbmZpcm1hdGlvbkZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG4gIHJlc2V0UGFzc3dvcmRFbWFpbEZvcm1Db250cm9sOiBBYnN0cmFjdENvbnRyb2w7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmJhbi10eXBlc1xuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxuICAgIEBJbmplY3QoZm9yd2FyZFJlZigoKSA9PiBOZ3hBdXRoRmlyZWJhc2VVSUNvbmZpZ1Rva2VuKSkgcHVibGljIGNvbmZpZzogTmd4QXV0aEZpcmViYXNlVUlDb25maWcsXG4gICAgcHVibGljIGF1dGg6IEFuZ3VsYXJGaXJlQXV0aCxcbiAgICBwdWJsaWMgYXV0aFByb2Nlc3M6IEF1dGhQcm9jZXNzU2VydmljZSxcbiAgICBwdWJsaWMgZGlhbG9nOiBNYXREaWFsb2csXG4gICAgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUsXG4gICAgcHJpdmF0ZSBjaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWZcbiAgKSB7XG4gICAgdGhpcy5vblN1Y2Nlc3MgPSBhdXRoUHJvY2Vzcy5vblN1Y2Nlc3NFbWl0dGVyO1xuICAgIHRoaXMub25FcnJvciA9IGF1dGhQcm9jZXNzLm9uRXJyb3JFbWl0dGVyO1xuICB9XG5cbiAgZ2V0IGNvbG9yKCk6IHN0cmluZyB8IFRoZW1lUGFsZXR0ZSB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aGVudGljYXRpb25FcnJvciA/ICd3YXJuJyA6ICdwcmltYXJ5JztcbiAgfVxuXG4gIHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgdGhpcy5vbkVycm9yU3Vic2NyaXB0aW9uID0gdGhpcy5vbkVycm9yLnN1YnNjcmliZSgoKSA9PiB0aGlzLmF1dGhlbnRpY2F0aW9uRXJyb3IgPSB0cnVlKTtcbiAgICB9XG4gICAgdGhpcy5taW4gPSB0aGlzLm1pbiAhPSBudWxsID8gTWF0aC5tYXgodGhpcy5taW4sIHRoaXMuY29uZmlnLnBhc3N3b3JkTWluTGVuZ3RoKSA6IHRoaXMuY29uZmlnLnBhc3N3b3JkTWluTGVuZ3RoO1xuICAgIHRoaXMubWF4ID0gdGhpcy5tYXggIT0gbnVsbCA/IE1hdGgubWluKHRoaXMubWF4LCB0aGlzLmNvbmZpZy5wYXNzd29yZE1heExlbmd0aCkgOiB0aGlzLmNvbmZpZy5wYXNzd29yZE1heExlbmd0aDtcblxuICAgIHRoaXMuZ29CYWNrVVJMID0gdGhpcy5jaG9vc2VCYWNrVXJsKCk7XG5cbiAgICB0aGlzLnVwZGF0ZUF1dGhTbmFja2Jhck1lc3NhZ2VzKCk7XG4gICAgLy8gYXV0aCBmb3JtJ3MgaW5pdGlhbGl6YXRpb25cbiAgICB0aGlzLl9pbml0U2lnbkluRm9ybUdyb3VwQnVpbGRlcigpO1xuICAgIHRoaXMuX2luaXRTaWduVXBGb3JtR3JvdXBCdWlsZGVyKCk7XG4gICAgdGhpcy5faW5pdFJlc2V0UGFzc3dvcmRGb3JtR3JvdXBCdWlsZGVyKCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucGFzc3dvcmRTdHJlbmd0aCkge1xuICAgICAgdGhpcy5wYXNzd29yZFN0cmVuZ3RoLm9uU3RyZW5ndGhDaGFuZ2VkLnN1YnNjcmliZSgoc3RyZW5ndGg6IG51bWJlcikgPT4ge1xuICAgICAgICB0aGlzLm9uU3RyZW5ndGhDaGFuZ2VkLmVtaXQoc3RyZW5ndGgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xuICAgIGlmIChjaGFuZ2VzLm1lc3NhZ2VPbkF1dGhTdWNjZXNzIHx8IGNoYW5nZXMubWVzc2FnZU9uQXV0aEVycm9yKSB7XG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTbmFja2Jhck1lc3NhZ2VzKCk7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzLm1pbikge1xuICAgICAgdGhpcy5taW4gPSB0aGlzLm1pbiAhPSBudWxsID8gTWF0aC5tYXgodGhpcy5taW4sIHRoaXMuY29uZmlnLnBhc3N3b3JkTWluTGVuZ3RoKSA6IHRoaXMuY29uZmlnLnBhc3N3b3JkTWluTGVuZ3RoO1xuICAgIH1cbiAgICBpZiAoY2hhbmdlcy5tYXgpIHtcbiAgICAgIHRoaXMubWF4ID0gdGhpcy5tYXggIT0gbnVsbCA/IE1hdGgubWluKHRoaXMubWF4LCB0aGlzLmNvbmZpZy5wYXNzd29yZE1heExlbmd0aCkgOiB0aGlzLmNvbmZpZy5wYXNzd29yZE1heExlbmd0aDtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXMuZ29CYWNrVVJMKSB7XG4gICAgICB0aGlzLmdvQmFja1VSTCA9IHRoaXMuY2hvb3NlQmFja1VybCgpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLm9uRXJyb3JTdWJzY3JpcHRpb24pIHtcbiAgICAgIHRoaXMub25FcnJvclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9uVGFiQ2hhbmdlKGV2ZW50OiBNYXRUYWJDaGFuZ2VFdmVudCkge1xuICAgIHRoaXMuc2VsZWN0ZWRUYWJDaGFuZ2UuZW1pdChldmVudCk7XG4gICAgdGhpcy50YWJJbmRleCA9IGV2ZW50LmluZGV4O1xuICB9XG5cbiAgYXN5bmMgc2lnbk91dCgpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIGF3YWl0IHRoaXMuYXV0aFByb2Nlc3Muc2lnbk91dCgpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy50YWJJbmRleCA9IDA7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNpZ25JbigpIHtcbiAgICBpZiAoIXRoaXMuc2lnbkluRm9ybUdyb3VwLnZhbGlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduSW5XaXRoKHRoaXMuYXV0aFByb3ZpZGVycy5FbWFpbEFuZFBhc3N3b3JkLCB7XG4gICAgICAgIGVtYWlsOiB0aGlzLnNpZ25JbkZvcm1Hcm91cC52YWx1ZS5lbWFpbCxcbiAgICAgICAgcGFzc3dvcmQ6IHRoaXMuc2lnbkluRm9ybUdyb3VwLnZhbHVlLnBhc3N3b3JkXG4gICAgICB9KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlQXV0aFNuYWNrYmFyTWVzc2FnZXMoKTogdm9pZCB7XG4gICAgdGhpcy5hdXRoUHJvY2Vzcy5tZXNzYWdlT25BdXRoU3VjY2VzcyA9IHRoaXMubWVzc2FnZU9uQXV0aFN1Y2Nlc3M7XG4gICAgdGhpcy5hdXRoUHJvY2Vzcy5tZXNzYWdlT25BdXRoRXJyb3IgPSB0aGlzLm1lc3NhZ2VPbkF1dGhFcnJvcjtcbiAgfVxuXG4gIGNyZWF0ZUZvcmdvdFBhc3N3b3JkVGFiKCkge1xuICAgIHRoaXMucGFzc3dvcmRSZXNldFdpc2hlZCA9IHRydWU7XG4gICAgdGhpcy50YWJJbmRleCA9IDI7XG4gICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgfVxuXG4gIHByb2Nlc3NMZWdhbFNpZ25VUChhdXRoUHJvdmlkZXI/OiBBdXRoUHJvdmlkZXIpIHtcbiAgICBpZiAodGhpcy50b3NVcmwgfHwgdGhpcy5wcml2YWN5UG9saWN5VXJsKSB7XG4gICAgICBjb25zdCBwYXJhbXM6IExlZ2FsaXR5RGlhbG9nUGFyYW1zID0ge1xuICAgICAgICB0b3NVcmw6IHRoaXMudG9zVXJsLFxuICAgICAgICBwcml2YWN5UG9saWN5VXJsOiB0aGlzLnByaXZhY3lQb2xpY3lVcmwsXG4gICAgICAgIGF1dGhQcm92aWRlclxuICAgICAgfTtcblxuICAgICAgdGhpcy5kaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKExlZ2FsaXR5RGlhbG9nQ29tcG9uZW50LCB7ZGF0YTogcGFyYW1zfSk7XG4gICAgICB0aGlzLmRpYWxvZ1JlZi5hZnRlckNsb3NlZCgpLnN1YnNjcmliZSgocmVzdWx0OiBMZWdhbGl0eURpYWxvZ1Jlc3VsdCkgPT4ge1xuICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5jaGVja2VkKSB7XG4gICAgICAgICAgdGhpcy5fYWZ0ZXJTaWduVXBNaWRkbGV3YXJlKHJlc3VsdC5hdXRoUHJvdmlkZXIpLnRoZW4oKCkgPT4gdGhpcy5zaWduVXBGb3JtR3JvdXAucmVzZXQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaWFsb2dSZWYgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2FmdGVyU2lnblVwTWlkZGxld2FyZShhdXRoUHJvdmlkZXIpLnRoZW4oKCkgPT4gdGhpcy5zaWduVXBGb3JtR3JvdXAucmVzZXQoKSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2lnblVwKCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXV0aFByb2Nlc3Muc2lnblVwKFxuICAgICAgICB0aGlzLnNpZ25VcEZvcm1Hcm91cC52YWx1ZS5uYW1lLFxuICAgICAgICB7XG4gICAgICAgICAgZW1haWw6IHRoaXMuc2lnblVwRm9ybUdyb3VwLnZhbHVlLmVtYWlsLFxuICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnNpZ25VcEZvcm1Hcm91cC52YWx1ZS5wYXNzd29yZFxuICAgICAgICB9XG4gICAgICApO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzaWduVXBBbm9ueW1vdXNseSgpIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIGF3YWl0IHRoaXMuYXV0aFByb2Nlc3Muc2lnbkluV2l0aCh0aGlzLmF1dGhQcm92aWRlci5BTk9OWU1PVVMpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gIH1cblxuXG4gIHJlc2V0UGFzc3dvcmQoKSB7XG4gICAgdGhpcy5hdXRoUHJvY2Vzcy5yZXNldFBhc3N3b3JkKHRoaXMucmVzZXRQYXNzd29yZEVtYWlsRm9ybUNvbnRyb2wudmFsdWUpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHRoaXMucGFzc1Jlc2V0ID0gdHJ1ZTtcbiAgICAgICAgLy8gdGhpcy50YWJJbmRleCA9IDI7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgY2hvb3NlQmFja1VybCgpIHtcbiAgICByZXR1cm4gdGhpcy5hY3RpdmF0ZWRSb3V0ZS5zbmFwc2hvdC5xdWVyeVBhcmFtcy5yZWRpcmVjdFVybCB8fCB0aGlzLmdvQmFja1VSTCB8fCAnLyc7XG4gIH1cblxuICBwcml2YXRlIF9pbml0U2lnbkluRm9ybUdyb3VwQnVpbGRlcigpIHtcbiAgICB0aGlzLnNpZ25JbkZvcm1Hcm91cCA9IG5ldyBGb3JtR3JvdXAoe30pO1xuICAgIHRoaXMuc2lnbkluRm9ybUdyb3VwLnJlZ2lzdGVyQ29udHJvbCgnZW1haWwnLCB0aGlzLnNpZ25JbkVtYWlsRm9ybUNvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woJycsXG4gICAgICBbXG4gICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgIFZhbGlkYXRvcnMucGF0dGVybihFTUFJTF9SRUdFWClcbiAgICAgIF0pKTtcbiAgICB0aGlzLnNpZ25JbkZvcm1Hcm91cC5yZWdpc3RlckNvbnRyb2woJ3Bhc3N3b3JkJywgdGhpcy5zaWdJblBhc3N3b3JkRm9ybUNvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woJycsXG4gICAgICBbXG4gICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgIFZhbGlkYXRvcnMubWluTGVuZ3RoKHRoaXMubWluKSxcbiAgICAgICAgVmFsaWRhdG9ycy5tYXhMZW5ndGgodGhpcy5tYXgpXG4gICAgICBdKSk7XG4gIH1cblxuICBwcml2YXRlIF9pbml0U2lnblVwRm9ybUdyb3VwQnVpbGRlcigpIHtcbiAgICB0aGlzLnNpZ25VcEZvcm1Hcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgbmFtZTogdGhpcy5zaWdVcE5hbWVGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgICAgW1xuICAgICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgICAgVmFsaWRhdG9ycy5taW5MZW5ndGgodGhpcy5jb25maWcubmFtZU1pbkxlbmd0aCksXG4gICAgICAgICAgVmFsaWRhdG9ycy5tYXhMZW5ndGgodGhpcy5jb25maWcubmFtZU1heExlbmd0aClcbiAgICAgICAgXSksXG4gICAgICBlbWFpbDogdGhpcy5zaWdVcEVtYWlsRm9ybUNvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woJycsXG4gICAgICAgIFtcbiAgICAgICAgICBWYWxpZGF0b3JzLnJlcXVpcmVkLFxuICAgICAgICAgIFZhbGlkYXRvcnMucGF0dGVybihFTUFJTF9SRUdFWClcbiAgICAgICAgXSksXG4gICAgICBwYXNzd29yZDogdGhpcy5zaWdVcFBhc3N3b3JkRm9ybUNvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woJycsXG4gICAgICAgIFtcbiAgICAgICAgICBWYWxpZGF0b3JzLnJlcXVpcmVkLFxuICAgICAgICAgIFZhbGlkYXRvcnMubWluTGVuZ3RoKHRoaXMubWluKSxcbiAgICAgICAgICBWYWxpZGF0b3JzLm1heExlbmd0aCh0aGlzLm1heCksXG4gICAgICAgIF0pXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9pbml0UmVzZXRQYXNzd29yZEZvcm1Hcm91cEJ1aWxkZXIoKSB7XG4gICAgdGhpcy5yZXNldFBhc3N3b3JkRm9ybUdyb3VwID0gbmV3IEZvcm1Hcm91cCh7XG4gICAgICBlbWFpbDogdGhpcy5yZXNldFBhc3N3b3JkRW1haWxGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgnJyxcbiAgICAgICAgW1xuICAgICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWQsXG4gICAgICAgICAgVmFsaWRhdG9ycy5wYXR0ZXJuKEVNQUlMX1JFR0VYKVxuICAgICAgICBdKVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfYWZ0ZXJTaWduVXBNaWRkbGV3YXJlKGF1dGhQcm92aWRlcj86IEF1dGhQcm92aWRlcikge1xuICAgIGlmIChhdXRoUHJvdmlkZXIgPT09IHRoaXMuYXV0aFByb3ZpZGVyLkFOT05ZTU9VUykge1xuICAgICAgcmV0dXJuIHRoaXMuc2lnblVwQW5vbnltb3VzbHkoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc2lnblVwKCk7XG4gIH1cblxufVxuIl19